---
title: "S0_Annales"
prefer-html: true
format:
    html:
        toc: true
        toc-depth: 5
        toc-title: "Table of contents"
        toc-location: left
        toc-sticky: true
        number-sections: true
        theme: default
        include-in-header:
            - text: |
                <style>
                    table td, table th {
                    padding: 0.2cm;
                    }
                </style>

    docx:
        toc: true
        toc-depth: 5

    pdf:
        toc: true
        toc-depth: 5
        toc-title: "Table des matières"
        pdf-engine: xelatex
        number-sections: true
        header-includes: |
            % Force la police Computer Modern pour le titre principal
            \makeatletter
            \renewcommand{\maketitle}{
            \begin{center}
                {\Large\bfseries\rmfamily \@title \par}
                \vskip 1.5em
                {\large\rmfamily \@author \par}
                \vskip 1em
            \end{center}
            }
            \makeatother
            % Tous les titres en police par défaut LaTeX
            \usepackage{sectsty}
            \allsectionsfont{\rmfamily}

            \usepackage{etoolbox}
            \renewcommand{\contentsname}{}
            \AtBeginDocument{
                \addtocontents{toc}{\protect\smallskip}
                \let\oldtableofcontents\tableofcontents
                \renewcommand{\tableofcontents}{
                \begingroup
                    \footnotesize
                    \setlength{\parskip}{2pt}
                    \oldtableofcontents
                \endgroup
                }
            }
            \setcounter{tocdepth}{5}
            \makeatletter
            \renewcommand{\@tocrmarg}{0pt}
            \makeatother

            \usepackage{fvextra}
            \usepackage[section]{placeins}

            % Gestion des chunks de code
            \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}

            \usepackage{needspace}
            \usepackage{float}
            \floatplacement{figure}{H}
            \floatplacement{table}{H}

            \newcommand{\sectionbreak}{\needspace{5\baselineskip}}
            \setlength{\parindent}{0pt}
            \setlength{\parskip}{4pt}

            \usepackage[most]{tcolorbox}
            \usepackage{color}
            \definecolor{lightgray}{gray}{0.95}
            \newtcolorbox{graybox}{colback=gray!10!white,colframe=black,boxrule=0.6pt,arc=1mm,left=6pt,right=6pt,top=4pt,bottom=4pt}
            \newtcolorbox{codebox}{breakable,colback=blue!5!white,colframe=blue!50!black,boxrule=0.5pt,arc=1mm,left=4pt,right=4pt,top=3pt,bottom=3pt}
            \DefineVerbatimEnvironment{CodeBoxContent}{Verbatim}{fontsize=\small,breaklines,breakanywhere}

            \renewcommand{\thesection}{\arabic{section}}
            \renewcommand{\thesubsection}{\thesection.\Alph{subsection}}
            \renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}
            % Increase table cell padding
            \usepackage{makecell}
            \setcellgapes{0.2cm}
            \makegapedcells
            \setlength{\tabcolsep}{0.2cm}

geometry: margin=2.5cm
---

```{r}
#| label: setup
#| include: false
#| echo: false
library(forecast)
library(plotrix)
library(randomForest)
library(tidyr)
library(epiR)
library(DHARMa)
library(viridisLite)
library(ggplot2)
library(binom)
library(survminer)
library(pROC)
library(treemap)
library(psy)
library(MASS)
library(rpart)
library(logbin)
library(rpart.plot)
library(plotly)
library(lmerTest)
library(psych)
library(lme4)
library(prettyR)
library(kableExtra)
library(gtsummary)
library(dplyr)
library(lattice)
library(survey)
library(mice)
library(qgraph)
library(nlme)
library(pwr)
library(guideR)
library(ape)
library(survival)
library(gmodels)
library(httpgd)
library(e1071)
library(psy)
library(reshape2)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.height = 6)

load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
gs <- read.csv2("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/GoogleSuicide20172022.csv")
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/dataAQRlivre")
data(expsy)
```

\newpage

# 2000

## Question 1

::: callout-note
Un test de comparaison de deux moyennes (test t) abouti au résultat : p = 0,024. Comment peut-on interpréter cette valeur ? (4 points)
:::

### Réponse

-   Il existe une différence statistiquement significative entre les deux moyennes

-   Dans l'hypothèse de Fisher :

    -   La probabilité que le résultat observé (ou plus extrême) se produise si l'hypothèse nulle est vraie est de 2,4 %

-   Dans l'hypothèse de Neyman-Pearson :

    -   On compare cette valeur a un seuil de significativité établi précédemment

    -   Dans l'hypothèse que l'on recherche une supériorité uniquement, on rejette l'hypothèse nulle si p \< 0,025 car on effectue un test unilatéral

    -   On formule $H_0$ : il n'y a pas de différence entre les deux moyennes

    -   On formule $H_1$ : il y a une moyenne plus élevée dans le groupe A que dans le groupe B

    -   Dans ce cas, on rejette $H_0$ et on accepte $H_1$ car p \< 0,025

\newpage

## Question 2

::: callout-note
Quelles sont les définitions d’un odds-ratio et d’un risque relatif ? Quels sont les avantages et inconvénients de ces deux paramètres ? (4 points)
:::

### \*\*Réponse

Les deux sont des mesures **D'ASSOCIATION** permettant de **QUANTIFIER** le lien entre 2 variables. Par exemple, l'existence d'une infection (X=1) et le décès (Y=1).

On peut faire un tableau de contingence 2x2 :

|                       | Y=1 (décès) | Y=0 (survie) | Total |
|-----------------------|-------------|--------------|-------|
| X=1 (infection)       | a           | b            | a+b   |
| X=0 (pas d'infection) | c           | d            | c+d   |
| Total                 | a+c         | b+d          | N     |

#### Risque Relatif (RR)

Le risque relatif est le rapport des risques (probabilités) d'un évènement entre deux groupes.

Formule : $RR = \frac{P(\text{evenement } | \text{ exposes})}{P(\text{evenement } | \text{ non-exposes})} = \frac{a/(a+b)}{c/(c+d)}$

Il compare la probabilité que l'événement se produise chez les patients exposés (X=1) au risque chez les patients non exposés (X=0),.

Interprétation : **multiplicatif** : on a $RR$ fois plus de risque de décès si on est infecté

#### Odds ratio (OR)

L'OR est est le rapport des **cotes** = des probabilités de survenue des évènements

C'est la proportion de survenue de l'évènement sur la proportion de survenue de l'évènement chez les non exposés

$$
OR = \frac{\text{proportion(evenement chez exposes)}}{\text{proportion(evenement chez non exposes)}} = \frac{a}{b}/\frac{c}{d} = \frac{a \times d}{b \times c}
$$

-   **Interprétation** : L'OR est interprété comme le nombre de fois plus de "morts par rapport aux vivants" (cote) si l'on est exposé, par rapport aux non-exposés.

-   Quand la prévalence de maladie est faible (\< 10 %), l'OR approxime le RR, sinon il le surestime (si RR \> 1) ou le sous-estime (si RR \< 1)

Les deux paramètres $RR$ et $OR$ varient de 0 à l'infini.

Si leur valeur est de 1, cela signifie qu'il n'y a pas d'association entre X et Y, et les variables sont indépendantes.

#### Comparaison Risque Relatif (RR) vs Odds Ratio (OR)

| Caractéristique | Risque Relatif (RR) | Odds Ratio (OR) |
|----------------------|----------------------------|-----------------------|
| **Avantages** | Facilement interprétable.<br>Représente le facteur par lequel le risque d’événement est multiplié en présence du facteur d’exposition. | Estimable en étude cas-témoins.<br>Possède de bonnes propriétés statistiques et mathématiques.<br>Symétrique : l’OR d’un non-événement est l’inverse de l’OR d’un événement.<br>Indispensable en régression logistique. |
| **Inconvénients** | Non estimable dans certains types d’études, notamment les cas-témoins.<br>Asymétrique : le RR d’un non-événement n’est pas égal à 1/RR.<br>Dépend fortement de la proportion d’événements. | Interprétation moins intuitive.<br>Souvent confondu avec le RR.<br>Surestime le RR si l’événement est fréquent (\> 10 %). |
| **Relation OR / RR** | Si l’événement est rare (\< 10 %), RR ≈ OR. | Si l’événement est fréquent (\> 10 %), l’OR surestime le RR (il est plus éloigné de 1). |

**En résumé,** l'Odds Ratio est une mesure plus flexible et est la mesure d'association naturelle des modèles logistiques, car il ne dépend pas de la proportion de l'événement (contrairement au RR),.

Toutefois, le Risque Relatif est généralement préféré pour son interprétation plus directe en termes d'augmentation ou de diminution du risque.

\newpage

## Question 3

::: callout-note
Comment interpréter les résultats d’une analyse de variance à deux facteurs croisés avec interaction ? Donnez un exemple. (4 points)
:::

### Réponse

Déjà : L’ANOVA est un cas particulier de régression utilisée quand les variables explicatives sont uniquement des catégories (des groupes comme “Engrais A, B, C”).

Elle regarde si les moyennes de ces catégories diffèrent.

Dans une ANOVA à deux facteurs croisés avec interaction, on examine l'effet de deux variables indépendantes (facteurs) sur une variable dépendante, ainsi que l'interaction entre ces deux facteurs.

Interprétation des résultats :

-   Le terme d'interaction $X_1 \times X_2$ représente un effet multiplicatif / une synergie entre les deux variables explicatives.

-   Dans le cas où des termes d'interaction sont significatifs, cela indique que l'effet d'un facteur dépend du niveau de l'autre facteur.

    -   Dans ce cas, on ne peut donc pas interpréter les effets principaux de chaque facteur isolément.

-   Dans le cas où les termes d'interactio ne sont pas significatifs, on peut interpréter les effets principaux de chaque facteur indépendamment car l'effet n'est pas multiplicatif mais additif.

\newpage

## Question 4

::: callout-note
Une enquête épidémiologique tente de rechercher des facteurs de risque de cancer du sein.

Les facteurs de risques potentiels évalués sont : antécédent personnels de cancer du sein, antécédents familiaux de cancer du sein, poids, poids/taille au carré, âge, âge aux premières règles, âge aux dernières règles, nombre de grossesses, âge à la première grossesse, allaitement, prise de contraception orale normo dosée, prise de contraception orale mini dosée, prise de contraception orale micro dosée, traitement hormonal substitutif de la ménopause, consommation de café, consommation de cigarette, consommation d’alcool, niveau socio économique.

Quelle technique d’analyse proposez-vous ?

Comment décider des variables explicatives à introduire dans la régression ? (8 points)
:::

### Réponse

L'enquête épidémiologique visant à identifier des facteurs de risque de cancer du sein traite d'une variable dépendante (le cancer du sein) de nature **binaire (présence/absence)**.

Pour modéliser l'association entre une variable dépendante binaire et un ensemble de variables explicatives continues ou catégorielles (âge, antécédents, habitudes de vie, etc.), la technique d'analyse statistique la plus appropriée est la **Régression Logistique Multivariable** (RLM).

#### Technique d'Analyse Proposée : Régression Logistique Multivariable

La régression logistique est un type de Modèle Linéaire Généralisé (GLM) utilisant la fonction de lien **logit** et la distribution binomiale, c'est à dire que :

-   La variable à expliquer $Y$ suit une distribution de Bernoulli (0 ou 1, absence ou présence de cancer du sein).

-   La relation entre la probabilité de l'événement ($p = P(Y=1)$) et les variables explicatives ($X_1, X_2, \dots, X_p$) est modélisée via le logit.

-   Le modèle permet d'estimer l'effet de chaque facteur de risque potentiel sur la probabilité de cancer du sein, tout en ajustant pour les autres facteurs.

-   Il permet d'obtenir des **Odds Ratios (OR) ajustés** pour chaque facteur de risque, fournissant ainsi une estimation de l'association qui est purifiée de l'effet potentiellement confondant des autres variables présentes dans l'étude.

#### Conditions de Validité

La condition de validité la plus importante est d'avoir une **taille d'échantillon suffisante**.

Il est recommandé d'avoir au minimum **10 événements (cas de cancer) par variable explicative** dans le modèle.

Avec 18 facteurs potentiels, il faudrait idéalement inclure plus de 180 cas.

#### Décision des Variables Explicatives à Introduire dans la Régression

Processus de sélection :

-   D'abord, basé sur la littérature et sur les "hypothèses" cliniques

-   Puis basés sur les résultats d'analyses univariable, en définissant un seuil de p-value à partir duquel on pourra inclure la variable dans l'analyse multivariable

Certains recodage peuvent être nécessaires :

-   

#### A. Analyse Préliminaire et Construction de Variables

1.  **Examen des variables continues** : Il est nécessaire de vérifier l'hypothèse de **log-linéarité** pour les variables quantitatives (telles que le poids, l'âge, etc.). Si la relation entre le prédicteur et le *log-odds* n'est pas linéaire, ces variables peuvent devoir être transformées (par exemple, en prenant leur logarithme) ou catégorisées (par exemple, âge binarisé ou en classes).
2.  **Gestion de la colinéarité** : Le modèle doit éviter d'inclure des variables qui mesurent presque la même chose, car cela peut rendre les coefficients instables. Par exemple, le **poids** et l'indice **poids/taille au carré (IMC)** sont fortement corrélés. Il est généralement préférable de choisir l'IMC, qui a une pertinence clinique plus directe, et d'exclure les variables redondantes.
3.  **Recodage des variables catégorielles** : Les variables nominales (comme les différents types de contraception orale : normo dosée, mini dosée, micro dosée) sont incluses en utilisant des **variables indicatrices (ou *dummy variables*)** en choisissant une catégorie de référence (par exemple, "jamais de contraception orale").

#### B. Stratégie de Sélection (Inclusion/Exclusion)

La sélection peut se faire selon plusieurs approches, mais l'approche la plus courante en épidémiologie et en biostatistique s'appuie sur une combinaison de pertinence théorique et de signification statistique :

1.  **Inclusion Basée sur la Théorie/Clinique (Priorité)** : Les variables jugées essentielles pour la question scientifique doivent être incluses dans le modèle **quelle que soit leur significativité statistique** en analyse univariable. Cela inclut typiquement les **variables de confusion** connues (par exemple, l'âge, les antécédents familiaux), même si elles ne sont pas *a priori* associées au cancer dans l'échantillon d'étude.

2.  **Pré-sélection Statistique (Screening)** : Un premier tri est souvent effectué via une **régression logistique univariable** pour chaque facteur potentiel. Les variables montrant une association univariée avec le cancer (souvent avec un seuil de $p < 0,20$ ou $p < 0,10$) sont retenues comme candidates pour l'étape multivariable. Cette étape permet de réduire le nombre de candidats avant la modélisation complexe.

3.  **Construction du Modèle Multivariable** : Les variables retenues à l'étape précédente sont introduites dans un modèle multivariable unique. La décision finale d'inclure ou d'exclure des variables dans ce modèle est prise en testant l'effet de chaque facteur (Test de Wald ou Test du Rapport de Vraisemblance (LRT)).

    -   L'utilisation du **Test du Rapport de Vraisemblance (LRT)** est souvent préférée au Test de Wald, car il est plus robuste pour tester l'effet d'un groupe de variables (par exemple, pour une variable catégorielle) ou en cas de petit échantillon ou d'événements rares.

4.  **Recherche d'Interactions** : Une fois le modèle principal établi, il est important d'évaluer les **interactions** entre les principaux facteurs de risque. L'interaction modélise une **synergie**, c'est-à-dire que l'effet d'un facteur sur le cancer dépend du niveau d'un autre facteur (par exemple, si l'effet du poids est plus marqué chez les femmes ayant des antécédents familiaux). L'ajout d'un terme multiplicatif ($X_i \times X_j$) permet de lever l'hypothèse de multiplicativité des OR et d'évaluer cet effet combiné.

------------------------------------------------------------------------

En conclusion, la méthode de la régression logistique multivariable permet d'obtenir des **Odds Ratios ajustés** pour chaque facteur de risque, fournissant ainsi une estimation de l'association qui est purifiée de l'effet potentiellement confondant des autres variables présentes dans l'étude.