<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Résumé statistique – Mes notes de cours</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./6_effet_centre.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-99913b7803b80b0c1d2b970a25816663.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1_resume_statistique.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Résumé statistique</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mes notes de cours</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Mes notes de cours</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_resume_statistique.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Résumé statistique</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_effet_centre.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">6 Effet centre</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#position-et-dispersion" id="toc-position-et-dispersion" class="nav-link active" data-scroll-target="#position-et-dispersion"><span class="header-section-number">3</span> Position et dispersion</a>
  <ul>
  <li><a href="#position" id="toc-position" class="nav-link" data-scroll-target="#position"><span class="header-section-number">3.1</span> Position</a>
  <ul>
  <li><a href="#moyenne" id="toc-moyenne" class="nav-link" data-scroll-target="#moyenne"><span class="header-section-number">3.1.1</span> Moyenne</a></li>
  <li><a href="#médiane" id="toc-médiane" class="nav-link" data-scroll-target="#médiane"><span class="header-section-number">3.1.2</span> Médiane</a></li>
  <li><a href="#mode" id="toc-mode" class="nav-link" data-scroll-target="#mode"><span class="header-section-number">3.1.3</span> Mode</a></li>
  </ul></li>
  <li><a href="#dispersion" id="toc-dispersion" class="nav-link" data-scroll-target="#dispersion"><span class="header-section-number">3.2</span> Dispersion</a>
  <ul>
  <li><a href="#étendue-empan" id="toc-étendue-empan" class="nav-link" data-scroll-target="#étendue-empan"><span class="header-section-number">3.2.1</span> Étendue = empan</a></li>
  <li><a href="#écart-interquartile-iqr" id="toc-écart-interquartile-iqr" class="nav-link" data-scroll-target="#écart-interquartile-iqr"><span class="header-section-number">3.2.2</span> Écart interquartile (IQR)</a></li>
  <li><a href="#écart-type" id="toc-écart-type" class="nav-link" data-scroll-target="#écart-type"><span class="header-section-number">3.2.3</span> Écart-type</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance"><span class="header-section-number">3.2.4</span> Variance</a></li>
  </ul></li>
  <li><a href="#exemple-sur-r" id="toc-exemple-sur-r" class="nav-link" data-scroll-target="#exemple-sur-r"><span class="header-section-number">3.3</span> Exemple sur R</a></li>
  </ul></li>
  <li><a href="#analyses-en-sous-groupe" id="toc-analyses-en-sous-groupe" class="nav-link" data-scroll-target="#analyses-en-sous-groupe"><span class="header-section-number">4</span> Analyses en sous groupe</a>
  <ul>
  <li><a href="#principe" id="toc-principe" class="nav-link" data-scroll-target="#principe"><span class="header-section-number">4.1</span> Principe</a></li>
  <li><a href="#dans-r" id="toc-dans-r" class="nav-link" data-scroll-target="#dans-r"><span class="header-section-number">4.2</span> Dans R</a></li>
  </ul></li>
  <li><a href="#dépendance-liaison-et-association" id="toc-dépendance-liaison-et-association" class="nav-link" data-scroll-target="#dépendance-liaison-et-association"><span class="header-section-number">5</span> Dépendance, liaison et association</a>
  <ul>
  <li><a href="#variables-quantitatives" id="toc-variables-quantitatives" class="nav-link" data-scroll-target="#variables-quantitatives"><span class="header-section-number">5.1</span> Variables quantitatives</a>
  <ul>
  <li><a href="#dépendance" id="toc-dépendance" class="nav-link" data-scroll-target="#dépendance"><span class="header-section-number">5.1.1</span> Dépendance</a></li>
  <li><a href="#dépendance-monotone-ou-linéaire" id="toc-dépendance-monotone-ou-linéaire" class="nav-link" data-scroll-target="#dépendance-monotone-ou-linéaire"><span class="header-section-number">5.1.2</span> Dépendance monotone ou linéaire</a>
  <ul class="collapse">
  <li><a href="#exemple-sur-r-1" id="toc-exemple-sur-r-1" class="nav-link" data-scroll-target="#exemple-sur-r-1"><span class="header-section-number">5.1.2.1</span> Exemple sur R</a>
  <ul class="collapse">
  <li><a href="#smp" id="toc-smp" class="nav-link" data-scroll-target="#smp"><span class="header-section-number">5.1.2.1.1</span> SMP</a></li>
  <li><a href="#données-simulées" id="toc-données-simulées" class="nav-link" data-scroll-target="#données-simulées"><span class="header-section-number">5.1.2.1.2</span> Données simulées</a></li>
  <li><a href="#matrice-de-corrélation" id="toc-matrice-de-corrélation" class="nav-link" data-scroll-target="#matrice-de-corrélation"><span class="header-section-number">5.1.2.1.3</span> Matrice de corrélation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#concordance" id="toc-concordance" class="nav-link" data-scroll-target="#concordance"><span class="header-section-number">5.1.3</span> Concordance</a>
  <ul class="collapse">
  <li><a href="#principle" id="toc-principle" class="nav-link" data-scroll-target="#principle"><span class="header-section-number">5.1.3.1</span> Principle</a></li>
  <li><a href="#exemple-sur-r-2" id="toc-exemple-sur-r-2" class="nav-link" data-scroll-target="#exemple-sur-r-2"><span class="header-section-number">5.1.3.2</span> Exemple sur R</a></li>
  </ul></li>
  <li><a href="#résumé-des-paramètres-de-dépendance-entre-deux-variables-quantitatives" id="toc-résumé-des-paramètres-de-dépendance-entre-deux-variables-quantitatives" class="nav-link" data-scroll-target="#résumé-des-paramètres-de-dépendance-entre-deux-variables-quantitatives"><span class="header-section-number">5.1.4</span> Résumé des paramètres de dépendance entre deux variables quantitatives</a></li>
  </ul></li>
  <li><a href="#variables-catégorielles" id="toc-variables-catégorielles" class="nav-link" data-scroll-target="#variables-catégorielles"><span class="header-section-number">5.2</span> Variables catégorielles</a>
  <ul>
  <li><a href="#dépendance-1" id="toc-dépendance-1" class="nav-link" data-scroll-target="#dépendance-1"><span class="header-section-number">5.2.1</span> Dépendance</a>
  <ul class="collapse">
  <li><a href="#chi2-et-associés" id="toc-chi2-et-associés" class="nav-link" data-scroll-target="#chi2-et-associés"><span class="header-section-number">5.2.1.1</span> Chi2 et associés</a></li>
  <li><a href="#odds-ratio-et-risque-relatif" id="toc-odds-ratio-et-risque-relatif" class="nav-link" data-scroll-target="#odds-ratio-et-risque-relatif"><span class="header-section-number">5.2.1.2</span> Odds-ratio et risque relatif</a></li>
  <li><a href="#exemple-sur-r-3" id="toc-exemple-sur-r-3" class="nav-link" data-scroll-target="#exemple-sur-r-3"><span class="header-section-number">5.2.1.3</span> Exemple sur R</a></li>
  </ul></li>
  <li><a href="#dépendance-monotone" id="toc-dépendance-monotone" class="nav-link" data-scroll-target="#dépendance-monotone"><span class="header-section-number">5.2.2</span> Dépendance monotone</a>
  <ul class="collapse">
  <li><a href="#exemple-sur-r-4" id="toc-exemple-sur-r-4" class="nav-link" data-scroll-target="#exemple-sur-r-4"><span class="header-section-number">5.2.2.1</span> Exemple sur R</a></li>
  </ul></li>
  <li><a href="#concordance-1" id="toc-concordance-1" class="nav-link" data-scroll-target="#concordance-1"><span class="header-section-number">5.2.3</span> Concordance</a>
  <ul class="collapse">
  <li><a href="#coefficient-kappa-de-cohen" id="toc-coefficient-kappa-de-cohen" class="nav-link" data-scroll-target="#coefficient-kappa-de-cohen"><span class="header-section-number">5.2.3.1</span> Coefficient kappa de Cohen</a></li>
  <li><a href="#sensibilité-spécificité-vpp-vpn" id="toc-sensibilité-spécificité-vpp-vpn" class="nav-link" data-scroll-target="#sensibilité-spécificité-vpp-vpn"><span class="header-section-number">5.2.3.2</span> Sensibilité, spécificité, VPP, VPN</a>
  <ul class="collapse">
  <li><a href="#exemple-1-sur-r" id="toc-exemple-1-sur-r" class="nav-link" data-scroll-target="#exemple-1-sur-r"><span class="header-section-number">5.2.3.2.1</span> Exemple 1 sur R</a></li>
  <li><a href="#exemple-2-sur-r" id="toc-exemple-2-sur-r" class="nav-link" data-scroll-target="#exemple-2-sur-r"><span class="header-section-number">5.2.3.2.2</span> Exemple 2 sur R</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Résumé statistique</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="position-et-dispersion" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Position et dispersion</h1>
<section id="position" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="position"><span class="header-section-number">3.1</span> Position</h2>
<p>Paramètres de position = valeurs qui résument la tendance centrale d’une distribution.</p>
<ul>
<li><p>Moyenne</p></li>
<li><p>Médiane</p></li>
<li><p>Mode</p></li>
</ul>
<section id="moyenne" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="moyenne"><span class="header-section-number">3.1.1</span> Moyenne</h3>
<p>Moyenne = somme des valeurs divisée par le nombre de valeurs.<br>
</p>
<p><span class="math display">\[
\frac{1}{n} \sum_{i=1}^{n} x_i
\]</span></p>
<p>Correspond au centre de gravité des points si on les représente sur une droite.</p>
<p>Hypothèses :</p>
<ul>
<li><p>Les valeurs sont indépendantes</p></li>
<li><p>Équivalence de la quantité (1 euro vaut 1 euro quelque soit sa position sur la droite des réels) : donc les notes c’est pas top en vrai !!</p></li>
<li><p>Les valeurs sont continues</p></li>
</ul>
</section>
<section id="médiane" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="médiane"><span class="header-section-number">3.1.2</span> Médiane</h3>
<p>Signification plus directe : valeur qui partage la distribution en deux parties égales.</p>
<p>Si la distribution est symétrique, la moyenne et la médiane sont égales.</p>
</section>
<section id="mode" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="mode"><span class="header-section-number">3.1.3</span> Mode</h3>
<p>Mode = valeur la plus fréquente.</p>
</section>
</section>
<section id="dispersion" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="dispersion"><span class="header-section-number">3.2</span> Dispersion</h2>
<p>Mesures de dispersion = valeurs qui résument la variabilité d’une distribution.</p>
<ul>
<li>Étendue = empan</li>
</ul>
<section id="étendue-empan" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="étendue-empan"><span class="header-section-number">3.2.1</span> Étendue = empan</h3>
<p>Correspond à la différence entre la valeur maximale et la valeur minimale.</p>
</section>
<section id="écart-interquartile-iqr" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="écart-interquartile-iqr"><span class="header-section-number">3.2.2</span> Écart interquartile (IQR)</h3>
<p>= Q3 - Q1</p>
</section>
<section id="écart-type" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="écart-type"><span class="header-section-number">3.2.3</span> Écart-type</h3>
<p>écart type = écart “le plus typique” par rapport à la moyenne.</p>
<p>Si <span class="math inline">\(m\)</span> est la moyenne des observations <span class="math inline">\(x_i\)</span>, l’écart type <span class="math inline">\(s\)</span> est défini par la racine carrée de la variance :</p>
<p><span class="math display">\[
s = \sqrt{[(x_1 - m^2) + \dots + (x_n - m)^2]/(n-1)}
\]</span></p>
<p>La variance correspond à la moyenne des carrés des écarts par rapport à la moyenne.</p>
<p>Donc en gros : écart type = racine carrée des carrés des écarts par rapport à la moyenne.</p>
<p>Pourquoi ajouter des carrés ?</p>
<ul>
<li><p>Positive les écarts négatifs</p></li>
<li><p>Accentue les écarts importants</p></li>
<li><p>Et pour une super propriété de l’écart-type :</p>
<ul>
<li>La variance de deux variables indépendantes est égale à la somme de leurs variances.</li>
</ul></li>
</ul>
<p>Comment l’interpréter ?</p>
<ul>
<li><p>Dans le cas d’une distribution normale,</p>
<ul>
<li><p>environ 2/3 des observations se situent à moins d’un écart-type de la moyenne.</p></li>
<li><p>environ la moitié des observations se situent à <span class="math inline">\([m - (2/3)s ; m + (2/3)s]\)</span></p></li>
</ul></li>
</ul>
<p>Avantages et inconvénients :</p>
<ul>
<li><p>Avantage :</p>
<ul>
<li><p>utilise toutes les valeurs de la distribution</p></li>
<li><p>propriétés mathématiques intéressantes : la variance de la somme de deux variables indépendantes est égale à la somme de leurs variances.</p></li>
<li><p>s’utilise dans de nombreux tests statistiques (t-test, ANOVA, régression linéaire, etc.)</p></li>
<li><p>Facile à manipuler mathématiquement</p></li>
<li><p>Interprétation claire dans le cas de distributions normales</p></li>
</ul></li>
<li><p>Inconvénient :</p>
<ul>
<li><p>sensible aux valeurs extrêmes (outliers)</p></li>
<li><p>ne s’interprète pas facilement dans le cas de distributions asymétriques</p></li>
<li><p>Pas adapté aux variables ordinales ou catégorielles</p></li>
</ul></li>
</ul>
</section>
<section id="variance" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="variance"><span class="header-section-number">3.2.4</span> Variance</h3>
<p>Variance = écart type au carré</p>
<p>ou moyenne des carrés des valeurs moins le carré de la moyenne.</p>
</section>
</section>
<section id="exemple-sur-r" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="exemple-sur-r"><span class="header-section-number">3.3</span> Exemple sur R</h2>
<p>Utilisation du jeu de données <code>smp.d</code> (version réduite de <code>smp</code>) et de la fonction <code>summary()</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(smp.d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age                profession    nb.enfants       depression    
 Min.   :19.00   ouvrier      :228   Min.   : 0.000   Min.   :0.0000  
 1st Qu.:28.00   sans.emploi  :221   1st Qu.: 0.000   1st Qu.:0.0000  
 Median :37.00   employé      :136   Median : 1.000   Median :0.0000  
 Mean   :38.94   commerçant   : 91   Mean   : 1.572   Mean   :0.3917  
 3rd Qu.:48.00   intermédiaire: 57   3rd Qu.: 2.000   3rd Qu.:1.0000  
 Max.   :84.00   (Other)      : 60   Max.   :14.000   Max.   :1.0000  
 NA's   :2       NA's         :  6   NA's   :26                       
 schizophrenie       gravite      recherche.nouv   evit.danger   
 Min.   :0.0000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :0.0000   Median :4.000   Median :2.000   Median :2.000  
 Mean   :0.0801   Mean   :3.635   Mean   :2.058   Mean   :1.865  
 3rd Qu.:0.0000   3rd Qu.:5.000   3rd Qu.:3.000   3rd Qu.:3.000  
 Max.   :1.0000   Max.   :7.000   Max.   :3.000   Max.   :3.000  
                  NA's   :4       NA's   :104     NA's   :108    
 dep.recompense 
 Min.   :1.000  
 1st Qu.:1.000  
 Median :2.000  
 Mean   :2.152  
 3rd Qu.:3.000  
 Max.   :3.000  
 NA's   :114    </code></pre>
</div>
</div>
<p>Deux inconvénients à la fonction <code>summary()</code>:</p>
<ul>
<li><p>Ne donne pas l’écart-type</p></li>
<li><p>La disposition des résultats n’est pas très claire.</p></li>
</ul>
<p>On peut utiliser la fonction <code>describe()</code> du package <code>prettyR</code> pour un résumé plus complet.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(smp.d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Description of smp.d </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Numeric 
                mean median    var    sd valid.n
age            38.94     37 175.72 13.26     797
nb.enfants      1.57      1   3.42  1.85     773
depression      0.39      0   0.24  0.49     799
schizophrenie   0.08      0   0.07  0.27     799
gravite         3.64      4   2.72  1.65     795
recherche.nouv  2.06      2   0.77  0.88     695
evit.danger     1.87      2   0.76  0.87     691
dep.recompense  2.15      2   0.69  0.83     685

 Factor 
          
profession ouvrier sans.emploi employé commerçant intermédiaire autre cadre
   Count    228.00      221.00  136.00      91.00         57.00 31.00    24
   Percent   28.54       27.66   17.02      11.39          7.13  3.88     3
          
profession &lt;NA&gt; agriculteur
   Count   6.00        5.00
   Percent 0.75        0.63
Mode ouvrier </code></pre>
</div>
</div>
</section>
</section>
<section id="analyses-en-sous-groupe" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Analyses en sous groupe</h1>
<section id="principe" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="principe"><span class="header-section-number">4.1</span> Principe</h2>
<p>Dans un essai thérapeutique, il faut décrire es caractéristiques des patients inclus dans chaque groupe de traitement.</p>
<p>Il faut donc les décrire en fonction de différentes modalités (groupes de traitement, sexe, âge, etc.)</p>
</section>
<section id="dans-r" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="dans-r"><span class="header-section-number">4.2</span> Dans R</h2>
<p>On peut aussi utiliser la fonction <code>table()</code> pour faire des tableaux de contingence.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    smp.d<span class="sc">$</span>profession, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    smp.d<span class="sc">$</span>depression,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">deparse.level=</span><span class="dv">2</span>, <span class="co"># deparse.level fait apparaître les noms des variables dans le tableau</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">useNA=</span><span class="st">"ifany"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                smp.d$depression
smp.d$profession   0   1
   agriculteur     3   2
   commerçant     65  26
   cadre          16   8
   intermédiaire  31  26
   employé        81  55
   ouvrier       132  96
   autre          22   9
   sans.emploi   132  89
   &lt;NA&gt;            4   2</code></pre>
</div>
</div>
<p>Si on voulait les pourcentages plutôt :</p>
<p>La fonction <code>prop.table()</code> permet de calculer des pourcentages à partir d’un tableau de contingence.</p>
<p>L’option <code>margin</code> permet de choisir si on veut les pourcentages par ligne (margin=1) ou par colonne (margin=2).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>) <span class="co"># pour afficher 3 décimales</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        smp.d<span class="sc">$</span>profession, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        smp.d<span class="sc">$</span>depression,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">deparse.level=</span><span class="dv">2</span>, <span class="co"># deparse.level fait apparaître les noms des variables dans le tableau</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">useNA=</span><span class="st">"ifany"</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin=</span><span class="dv">1</span>) <span class="co"># margin=1 pourcentage par ligne ; margin=2 pourcentage par colonne</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                smp.d$depression
smp.d$profession     0     1
   agriculteur   0.600 0.400
   commerçant    0.714 0.286
   cadre         0.667 0.333
   intermédiaire 0.544 0.456
   employé       0.596 0.404
   ouvrier       0.579 0.421
   autre         0.710 0.290
   sans.emploi   0.597 0.403
   &lt;NA&gt;          0.667 0.333</code></pre>
</div>
</div>
<p>Mais encore une fois, je trouve personnellement que le top est d’utiliser <code>tbl_summary</code> du package <code>gtsummary</code>.</p>
<p>Il va falloir me convaincre de ne pas utiliser ce banger absolu : je ne vois pas pourquoi.</p>
<p>A la limite, pourquoi pas <code>tableone</code> aussi.</p>
<p>avec <code>tableone</code> : (fait des tests t pour les variables continues et Chi2 / Fisher pour les catégorielles par défaut)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tableone)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>,<span class="st">"profession"</span>,<span class="st">"nb.enfants"</span>, <span class="st">"gravite"</span>,<span class="st">"recherche.nouv"</span>, <span class="st">"evit.danger"</span>,<span class="st">"dep.recompense"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>catVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"profession"</span>,<span class="st">"gravite"</span>,<span class="st">"recherche.nouv"</span>, <span class="st">"evit.danger"</span>,<span class="st">"dep.recompense"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> vars, <span class="at">data =</span> smp.d, <span class="at">factorVars =</span> catVars, <span class="at">strata =</span> <span class="st">"depression"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table1, <span class="at">showAllLevels =</span> <span class="cn">TRUE</span>, <span class="at">formatOptions =</span> <span class="fu">list</span>(<span class="at">digits =</span> <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Stratified by depression
                         level         0             1             p      test
  n                                      486           313                    
  age (mean (SD))                      39.93 (13.69) 37.41 (12.42)  0.009     
  profession (%)         agriculteur       3 ( 0.6)      2 ( 0.6)   0.333     
                         commerçant       65 (13.5)     26 ( 8.4)             
                         cadre            16 ( 3.3)      8 ( 2.6)             
                         intermédiaire    31 ( 6.4)     26 ( 8.4)             
                         employé          81 (16.8)     55 (17.7)             
                         ouvrier         132 (27.4)     96 (30.9)             
                         autre            22 ( 4.6)      9 ( 2.9)             
                         sans.emploi     132 (27.4)     89 (28.6)             
  nb.enfants (mean (SD))                1.57 (1.92)   1.58 (1.73)   0.936     
  gravite (%)            1               100 (20.7)      6 ( 1.9)  &lt;0.001     
                         2               111 (23.0)     18 ( 5.8)             
                         3                82 (17.0)     33 (10.5)             
                         4                89 (18.5)     74 (23.6)             
                         5                68 (14.1)    114 (36.4)             
                         6                26 ( 5.4)     55 (17.6)             
                         7                 6 ( 1.2)     13 ( 4.2)             
  recherche.nouv (%)     1               168 (38.5)     81 (31.3)   0.005     
                         2               107 (24.5)     50 (19.3)             
                         3               161 (36.9)    128 (49.4)             
  evit.danger (%)        1               229 (52.8)     86 (33.5)  &lt;0.001     
                         2               109 (25.1)     45 (17.5)             
                         3                96 (22.1)    126 (49.0)             
  dep.recompense (%)     1               121 (28.1)     71 (28.0)  &lt;0.001     
                         2               148 (34.3)     49 (19.3)             
                         3               162 (37.6)    134 (52.8)             </code></pre>
</div>
</div>
<p>avec <code>gtsummary</code> :</p>
<ul>
<li><p>(attention il a tendance à faire des tests de Wilcoxon par défaut pour les variables continues, il faut lui dire de faire des t-tests si on veut ça)</p></li>
<li><p>Pour les variables catégorielles, il fait par défaut des tests du Chi2 (ou Fisher si effectifs petits) donc autant ne pas lui donner d’instructions</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># utiliser smp.d.bis avec la variable depression en facteur recodé en "Dépressif" / "Non dépressif"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>smp.d.bis <span class="ot">&lt;-</span> smp.d</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>smp.d.bis<span class="sc">$</span>depression <span class="ot">&lt;-</span> <span class="fu">factor</span>(smp.d.bis<span class="sc">$</span>depression, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Non dépressif"</span>,<span class="st">"Dépressif"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> smp.d.bis <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl_summary</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> depression,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># all_continuous() ~ "{median} [{p25}, {p75}]",</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} / {N} ({p}%)"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">missing =</span> <span class="st">"no"</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Caractéristiques**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_overall</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_p</span>(</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># test = list( (rajouter si tests spécifiques pr les 2)</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_continuous</span>()  <span class="sc">~</span> <span class="st">"t.test"</span> <span class="co"># ou "wilcox.test" pour test non paramétrique </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># all_categorical() ~ "chisq.test" # ou "fisher.test" si effectifs petits</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ajouter les p-values pour les comparaisons entre groupes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Juste un peu chiant pour avoir un bel affichage en pdf mais franchement…</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tableau <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Conversion en objet kable (LaTeX standard)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_kable_extra</span>(<span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"6cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (Optionnel) Ajuste la taille de la police si le tableau est encore trop large</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"repeat_header"</span>), <span class="at">font_size =</span> <span class="dv">9</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<table class="table caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Caractéristiques</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Overall<br>
N = 799</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Non dépressif<br>
N = 486</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Dépressif<br>
N = 313</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">age</span></td>
<td style="text-align: center;">38.94 (13.26)</td>
<td style="text-align: center;">39.93 (13.69)</td>
<td style="text-align: center;">37.41 (12.42)</td>
<td style="text-align: center;">0.007</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">profession</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">agriculteur</td>
<td style="text-align: center;">5 / 793 (0.6%)</td>
<td style="text-align: center;">3 / 482 (0.6%)</td>
<td style="text-align: center;">2 / 311 (0.6%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">commerçant</td>
<td style="text-align: center;">91 / 793 (11%)</td>
<td style="text-align: center;">65 / 482 (13%)</td>
<td style="text-align: center;">26 / 311 (8.4%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">cadre</td>
<td style="text-align: center;">24 / 793 (3.0%)</td>
<td style="text-align: center;">16 / 482 (3.3%)</td>
<td style="text-align: center;">8 / 311 (2.6%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">intermédiaire</td>
<td style="text-align: center;">57 / 793 (7.2%)</td>
<td style="text-align: center;">31 / 482 (6.4%)</td>
<td style="text-align: center;">26 / 311 (8.4%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">employé</td>
<td style="text-align: center;">136 / 793 (17%)</td>
<td style="text-align: center;">81 / 482 (17%)</td>
<td style="text-align: center;">55 / 311 (18%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">ouvrier</td>
<td style="text-align: center;">228 / 793 (29%)</td>
<td style="text-align: center;">132 / 482 (27%)</td>
<td style="text-align: center;">96 / 311 (31%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">autre</td>
<td style="text-align: center;">31 / 793 (3.9%)</td>
<td style="text-align: center;">22 / 482 (4.6%)</td>
<td style="text-align: center;">9 / 311 (2.9%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">sans.emploi</td>
<td style="text-align: center;">221 / 793 (28%)</td>
<td style="text-align: center;">132 / 482 (27%)</td>
<td style="text-align: center;">89 / 311 (29%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">nb.enfants</span></td>
<td style="text-align: center;">1.57 (1.85)</td>
<td style="text-align: center;">1.57 (1.92)</td>
<td style="text-align: center;">1.58 (1.73)</td>
<td style="text-align: center;">&gt;0.9</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">schizophrenie</span></td>
<td style="text-align: center;">64 / 799 (8.0%)</td>
<td style="text-align: center;">29 / 486 (6.0%)</td>
<td style="text-align: center;">35 / 313 (11%)</td>
<td style="text-align: center;">0.008</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">gravite</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">1</td>
<td style="text-align: center;">106 / 795 (13%)</td>
<td style="text-align: center;">100 / 482 (21%)</td>
<td style="text-align: center;">6 / 313 (1.9%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">2</td>
<td style="text-align: center;">129 / 795 (16%)</td>
<td style="text-align: center;">111 / 482 (23%)</td>
<td style="text-align: center;">18 / 313 (5.8%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">3</td>
<td style="text-align: center;">115 / 795 (14%)</td>
<td style="text-align: center;">82 / 482 (17%)</td>
<td style="text-align: center;">33 / 313 (11%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">4</td>
<td style="text-align: center;">163 / 795 (21%)</td>
<td style="text-align: center;">89 / 482 (18%)</td>
<td style="text-align: center;">74 / 313 (24%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">5</td>
<td style="text-align: center;">182 / 795 (23%)</td>
<td style="text-align: center;">68 / 482 (14%)</td>
<td style="text-align: center;">114 / 313 (36%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">6</td>
<td style="text-align: center;">81 / 795 (10%)</td>
<td style="text-align: center;">26 / 482 (5.4%)</td>
<td style="text-align: center;">55 / 313 (18%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">7</td>
<td style="text-align: center;">19 / 795 (2.4%)</td>
<td style="text-align: center;">6 / 482 (1.2%)</td>
<td style="text-align: center;">13 / 313 (4.2%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">recherche.nouv</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.005</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">1</td>
<td style="text-align: center;">249 / 695 (36%)</td>
<td style="text-align: center;">168 / 436 (39%)</td>
<td style="text-align: center;">81 / 259 (31%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">2</td>
<td style="text-align: center;">157 / 695 (23%)</td>
<td style="text-align: center;">107 / 436 (25%)</td>
<td style="text-align: center;">50 / 259 (19%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">3</td>
<td style="text-align: center;">289 / 695 (42%)</td>
<td style="text-align: center;">161 / 436 (37%)</td>
<td style="text-align: center;">128 / 259 (49%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">evit.danger</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">1</td>
<td style="text-align: center;">315 / 691 (46%)</td>
<td style="text-align: center;">229 / 434 (53%)</td>
<td style="text-align: center;">86 / 257 (33%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">2</td>
<td style="text-align: center;">154 / 691 (22%)</td>
<td style="text-align: center;">109 / 434 (25%)</td>
<td style="text-align: center;">45 / 257 (18%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">3</td>
<td style="text-align: center;">222 / 691 (32%)</td>
<td style="text-align: center;">96 / 434 (22%)</td>
<td style="text-align: center;">126 / 257 (49%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;"><span style=" font-weight: bold;    ">dep.recompense</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">1</td>
<td style="text-align: center;">192 / 685 (28%)</td>
<td style="text-align: center;">121 / 431 (28%)</td>
<td style="text-align: center;">71 / 254 (28%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">2</td>
<td style="text-align: center;">197 / 685 (29%)</td>
<td style="text-align: center;">148 / 431 (34%)</td>
<td style="text-align: center;">49 / 254 (19%)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 6cm;" data-indentlevel="1">3</td>
<td style="text-align: center;">296 / 685 (43%)</td>
<td style="text-align: center;">162 / 431 (38%)</td>
<td style="text-align: center;">134 / 254 (53%)</td>
<td style="text-align: center;"></td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup>1</sup> Mean (SD); n / N (%)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup>2</sup> Welch Two Sample t-test; NA; Pearson's Chi-squared test</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>
</section>
</section>
<section id="dépendance-liaison-et-association" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Dépendance, liaison et association</h1>
<p>Deux variables sont dépendantes si une valeur donne une information sur l’autre.</p>
<p>Par exemple, le poids et la taille sont dépendantes : connaître la taille d’une personne permet d’avoir une idée de son poids.</p>
<section id="variables-quantitatives" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="variables-quantitatives"><span class="header-section-number">5.1</span> Variables quantitatives</h2>
<p>3 types de liaisons entre variables quantitatives :</p>
<ul>
<li><p>Dépendance : connaître X permet de mieux estimer Y (par exemple tabac et maladie respiratoire, taille et poids, etc.)</p></li>
<li><p>Dépendance monotone : X et Y varient dans le même sens (par exemple âge et pression artérielle)</p>
<ul>
<li><p>Dépendance linéaire : relation linéaire entre X et Y (par exemple taille et poids chez les adultes)</p></li>
<li><p>Corrélation</p></li>
<li><p>Variance partagée = proportion de la variance de Y expliquée par X dans une relation linéaire entre les deux variables</p></li>
</ul></li>
<li><p>Concordance : si X est plus grand pour un individu que pour un autre, alors Y est aussi plus grand pour le premier individu (par exemple taille et poids)</p>
<ul>
<li>pour une variable quantitative : coefficient de corrélation intraclasse (ICC)</li>
</ul></li>
</ul>
<section id="dépendance" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="dépendance"><span class="header-section-number">5.1.1</span> Dépendance</h3>
<p>Il n’existe pas de paramètre estimant parfaitement la dépendance ou l’indépendance entre deux variables quantitatives.</p>
<p>L’idéal serait d’avoir un paramètre <span class="math inline">\(\delta(X,Y)\)</span> valant 0 quand X et Y sont indépendantes et 1 quand elles sont parfaitement dépendantes.</p>
</section>
<section id="dépendance-monotone-ou-linéaire" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="dépendance-monotone-ou-linéaire"><span class="header-section-number">5.1.2</span> Dépendance monotone ou linéaire</h3>
<p>Le coefficient de corrélation de Pearson <span class="math inline">\(r\)</span> mesure la dépendance linéaire entre deux variables quantitatives X et Y.</p>
<p>Il est désigné par les lettres <span class="math inline">\(r\)</span> ou <span class="math inline">\(\rho\)</span> (rho), en référence à Karl Pearson qui l’a introduit en 1895.</p>
<p>Il varie entre -1 (les deux variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> sont parfaitement linéairement dépendantes de façon négative) et +1 (les deux variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> sont parfaitement linéairement dépendantes de façon positive).</p>
<p>Corrélaton nulle (<span class="math inline">\(r=0\)</span>) signifie que les deux variables sont linéairement indépendantes.</p>
<p>NB : le coefficient ne matérialise pas la <strong>force</strong> de la dépendance, mais seulement son <strong>type</strong> !</p>
<p>Pour matérialiser la force de la relation, on utilise le <strong>coefficient de détermination</strong> <span class="math inline">\(r^2\)</span>.</p>
<p>Le paramètre <span class="math inline">\(r^2\)</span> représente approximativement la <strong>proportion de la variance de</strong> <span class="math inline">\(Y\)</span> expliquée par la variance de <span class="math inline">\(X\)</span> dans une relation linéaire entre les deux variables.</p>
<p>C’est à dire :</p>
<ul>
<li><p><span class="math inline">\(X\)</span> est le nombre d’heures de révision</p></li>
<li><p><span class="math inline">\(Y\)</span> est la note obtenue à un examen</p></li>
</ul>
<p>On trouve un coefficent de corrélation <span class="math inline">\(r=0.8\)</span> entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>, alors <span class="math inline">\(r^2=0.64\)</span> soit 64%.</p>
<p>Donc : 64% de la variabilité (de la variance) des notes <span class="math inline">\(Y\)</span> s’expliquer par le le modèle linéaire basé sur le nombre d’heures de révision <span class="math inline">\(X\)</span>.</p>
<p>Ce n’est pas la même chose que “<span class="math inline">\(r^2\)</span>% des notes s’expliquent par le nombre d’heures de révision”.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Coefficient de corrélation</strong> <span class="math inline">\(r\)</span> :</p>
<ul>
<li><p>mesure la <strong>direction</strong> de la relation linéaire entre deux variables quantitatives.</p></li>
<li><p>varie entre -1 et +1 (avec 0 = pas de relation linéaire).</p></li>
<li><p>en pratique : mesure un peu la force quand même… mais il n’y a pas vraiment d’unité pour l’exprimer</p></li>
</ul>
<hr>
<p><strong>Coefficient de détermination</strong> <span class="math inline">\(r^2\)</span> :*</p>
<ul>
<li><p>mesure la <strong>force</strong> de la relation linéaire entre deux variables quantitatives avec une unité (en % de variance expliquée)</p></li>
<li><p>varie entre 0 et 1 (avec 0 = pas de relation linéaire).</p></li>
<li><p>représente la proportion de la variance de <span class="math inline">\(Y\)</span> expliquée par la variance de <span class="math inline">\(X\)</span> (et non pas le pourcentage de valeurs de <span class="math inline">\(Y\)</span> expliquées par <span class="math inline">\(X\)</span>).</p></li>
</ul>
</div>
</div>
<section id="exemple-sur-r-1" class="level4" data-number="5.1.2.1">
<h4 data-number="5.1.2.1" class="anchored" data-anchor-id="exemple-sur-r-1"><span class="header-section-number">5.1.2.1</span> Exemple sur R</h4>
<section id="smp" class="level5" data-number="5.1.2.1.1">
<h5 data-number="5.1.2.1.1" class="anchored" data-anchor-id="smp"><span class="header-section-number">5.1.2.1.1</span> SMP</h5>
<p>Représentation graphique de la relation entre l’âge et le nombre d’enfants dans le jeu de données <code>smp</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(smp<span class="sc">$</span>age, smp<span class="sc">$</span>nb.enfants,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Âge"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Nombre d'enfants"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Relation entre l'âge et le nombre d'enfants"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch=</span><span class="dv">19</span>) <span class="co"># pch = sert à choisir le type de point</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_resume_statistique_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Calcul du coefficient de corrélation de Pearson entre l’âge et le nombre d’enfants.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    smp<span class="sc">$</span>age, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    smp<span class="sc">$</span>nb.enfants, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">use=</span><span class="st">"complete.obs"</span>) <span class="co"># ignore les valeurs manquantes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.498</code></pre>
</div>
</div>
<p>Le coefficient de corrélation est de 0.498, ce qui indique une dépendance linéaire positive entre l’âge et le nombre d’enfants.</p>
</section>
<section id="données-simulées" class="level5" data-number="5.1.2.1.2">
<h5 data-number="5.1.2.1.2" class="anchored" data-anchor-id="données-simulées"><span class="header-section-number">5.1.2.1.2</span> Données simulées</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20230430</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>) <span class="co"># génère 100000 valeurs aléatoires suivant une loi normale</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y) <span class="co"># concatène les deux vecteurs x et y</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x,z)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Représentation graphique de la relation entre X1 et X2.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X1, X2,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"X1"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"X2"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Relation entre X1 et X2"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch=</span><span class="dv">19</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_resume_statistique_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Coorélation entre X1 et X2.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(X1, X2),<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.498</code></pre>
</div>
</div>
<p>Variance de X1 :</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">var</span>(X1),<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>logique ce soit = 1 car X1 est la concaténation de deux variables indépendantes de variance 1 (car générées par <code>rnorm</code> donc suivent une loi normale standard).</p>
<p>Pour calculer la variance partagée entre X1 et X2, on utilise la formule de la variance de la somme de deux variables aléatoires indépendantes :</p>
<p><span class="math display">\[
Var(X1 + X2) = Var(X1) + Var(X2) + 2Cov(X1, X2)
\]</span></p>
<p>Sur R :</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># corrélation de Pearson mise au carrée donne la part de variance partagée</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>rho2  <span class="ot">&lt;-</span> (<span class="fu">cor</span>(X1, X2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>rho2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.248</code></pre>
</div>
</div>
<p>Une autre manière d’obtenir ça :</p>
<ol type="1">
<li><p>Construire un modèle linéaire de <span class="math inline">\(Y\)</span> en fonction de <span class="math inline">\(X\)</span></p></li>
<li><p>Extraire la part de variance résiduelle (non expliquée par <span class="math inline">\(X\)</span>) du modèle</p></li>
<li><p>Variance expliquée par <span class="math inline">\(X\)</span> = <strong>1 - variance résiduelle</strong></p></li>
</ol>
<p>(mais <code>summary(lm())</code> donne directement le R² dans la partie “Multiple R-squared”)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(X1 <span class="sc">~</span> X2)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary donne l'info dans "Multiple R-squared"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = X1 ~ X2)

Residuals:
   Min     1Q Median     3Q    Max 
-5.079 -0.487 -0.001  0.486  4.867 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.00361    0.00194    1.86    0.063 .  
X2           0.49770    0.00194  256.59   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.868 on 199998 degrees of freedom
Multiple R-squared:  0.248, Adjusted R-squared:  0.248 
F-statistic: 6.58e+04 on 1 and 2e+05 DF,  p-value: &lt;2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance résiduelle</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">var</span>(<span class="fu">residuals</span>(res)),<span class="dv">3</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.754</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance expliquée par X2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">round</span>(<span class="fu">var</span>(<span class="fu">residuals</span>(res)),<span class="dv">3</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.246</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>NB : la variance partagée n’est pas la même chose que la covariance !!</strong></p>
<p>Covariance = mesure comment deux variables varient ensemble, positive si les deux variables augmentent ensemble, négative si l’une augmente quand l’autre diminue.</p>
<hr>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 49%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Paramètre</th>
<th>Symbole</th>
<th>Interprétation</th>
<th>Formule / calcul R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Coefficient de corrélation</td>
<td><span class="math inline">\(r\)</span> ou <span class="math inline">\(\rho\)</span></td>
<td>Direction et force de la relation linéaire entre deux variables quantitatives</td>
<td><code>cor(X, Y)</code></td>
</tr>
<tr class="even">
<td>Variance partagée</td>
<td><span class="math inline">\(r^2\)</span></td>
<td>Proportion de la variance de <span class="math inline">\(Y\)</span> expliquée par <span class="math inline">\(X\)</span> (force de la relation linéaire)</td>
<td><code>rho2 &lt;- cor(X, Y)^2</code></td>
</tr>
<tr class="odd">
<td>Covariance</td>
<td><span class="math inline">\(\mathrm{Cov}(X,Y)\)</span></td>
<td>Mesure comment deux variables varient ensemble (positive : ensemble, négative : sens inverse)</td>
<td><code>cov(X, Y)</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="matrice-de-corrélation" class="level5" data-number="5.1.2.1.3">
<h5 data-number="5.1.2.1.3" class="anchored" data-anchor-id="matrice-de-corrélation"><span class="header-section-number">5.1.2.1.3</span> Matrice de corrélation</h5>
<p>Pour calculer la matrice de corrélation entre plusieurs variables quantitatives, on peut utiliser la fonction <code>cor()</code> en lui passant un data frame ou une matrice.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>quanti <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>,<span class="st">"nb.enfants"</span>,<span class="st">"depression"</span>,<span class="st">"schizophrenie"</span>, <span class="st">"gravite"</span>,<span class="st">"recherche.nouv"</span>,<span class="st">"evit.danger"</span>,<span class="st">"dep.recompense"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(smp.d[,quanti],<span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>),<span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  age nb.enfants depression schizophrenie gravite
age             1.000      0.498     -0.093        -0.021  -0.127
nb.enfants      0.498      1.000      0.003        -0.003  -0.057
depression     -0.093      0.003      1.000         0.094   0.454
schizophrenie  -0.021     -0.003      0.094         1.000   0.318
gravite        -0.127     -0.057      0.454         0.318   1.000
recherche.nouv -0.223     -0.159      0.109         0.022   0.154
evit.danger    -0.027      0.004      0.256         0.081   0.230
dep.recompense -0.001     -0.023      0.089        -0.004   0.019
               recherche.nouv evit.danger dep.recompense
age                    -0.223      -0.027         -0.001
nb.enfants             -0.159       0.004         -0.023
depression              0.109       0.256          0.089
schizophrenie           0.022       0.081         -0.004
gravite                 0.154       0.230          0.019
recherche.nouv          1.000       0.081          0.071
evit.danger             0.081       1.000          0.119
dep.recompense          0.071       0.119          1.000</code></pre>
</div>
</div>
<p>On peut représenter ça graphiquement avec la fonction <code>corrplot()</code> du package <code>corrplot</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">cor</span>(smp.d[,quanti],<span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>),<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"circle"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">addCoef.col =</span> <span class="st">"red"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">"upper"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col=</span><span class="st">"black"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.srt=</span><span class="dv">45</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_resume_statistique_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Une matrice de corrélation est symétrique (mêmes valeurs de part et d’autre de la diagonale), car la corrélation entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> est la même que celle entre <span class="math inline">\(Y\)</span> et <span class="math inline">\(X\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>A quoi ça peut servir dans une étude rétropective ?</strong></p>
<p>Dans une étude qui compare 2 techniques chirurgicales (A vs B), la matrice de corrélation sert surtout à explorer et comprendre les relations entre les nombreuses variables mesurées autour de l’intervention.</p>
<ul>
<li><p>Explorer les facteurs pré-opératoires entre eux (âge corrélé au score ASA, etc.)</p></li>
<li><p>Repérer la colinéarité entre co-variables avant une régression ajustée</p></li>
<li><p>Relier facteurs pré-op et outcomes post-op (âge, IMC, ASA vs durée d’hospitalisation, perte sanguine, etc.)</p>
<ul>
<li>Notamment selon le type de chirurgie (groupe A vs groupe B) : est ce que les plus vieux ont plus de perte sanguine avec la technique A que B ?</li>
</ul></li>
</ul>
</div>
</div>
</section>
</section>
</section>
<section id="concordance" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="concordance"><span class="header-section-number">5.1.3</span> Concordance</h3>
<section id="principle" class="level4" data-number="5.1.3.1">
<h4 data-number="5.1.3.1" class="anchored" data-anchor-id="principle"><span class="header-section-number">5.1.3.1</span> Principle</h4>
<p>Par exemple, “concordance” entre deux échographies identiques fait par deux médecins différents.</p>
<p><strong>Variables quantitiatives : concordance mesurée par le coefficient de corrélation intraclasse (ICC).</strong></p>
<ul>
<li><p>ICC varie entre 0 (pas de concordance) et 1 (concordance parfaite).</p></li>
<li><p>Dans l’exemple du score échographique, le coefficient de corrélation intraclasse =</p></li>
</ul>
<p><span class="math display">\[
\frac{\text{variance inter-patients}}{\text{variance inter-patients} + \text{variance inter-radiologues} + \text{variance résiduelle}}
\]</span></p>
<p>Donc en gros : ICC = “<strong>vrai signal</strong>” / (“<strong>vrai signal</strong>” + “<strong>bruit</strong>”)</p>
<p>Vaut 1 quand il n’y a aucun bruit (variance inter-radiologues et résiduelle = 0).</p>
<p>Vaut 0 quand il n’y a que de bruit, donc les mesures sont totalement indépendantes entre elles.</p>
</section>
<section id="exemple-sur-r-2" class="level4" data-number="5.1.3.2">
<h4 data-number="5.1.3.2" class="anchored" data-anchor-id="exemple-sur-r-2"><span class="header-section-number">5.1.3.2</span> Exemple sur R</h4>
<p>Dans l’étude <code>smp</code>, 2 cliniciens sont présentés lors des entretiens : un junior et un senior.</p>
<p>A la fin de chaque entretien, ils remplissaient plusieurs questionnaires, dont un comportait l’échelle <em>CGI = Clinical Global Impression</em> (échelle de 1 à 7, 1 = pas malade, 7 = très malade).</p>
<p>Il est possible de quantifier le niveau de concordance entre les notes CGI données par le junior et le senior à l’aide du coefficient de corrélation intraclasse (ICC).</p>
<p>Dans ce cas : il s’agit d’un ICC de type “2-way random effects, absolute agreement, single rater/measurement” (notation ICC(2,1) de Shrout &amp; Fleiss, 1979).</p>
<ul>
<li><p>2-way random effects : les deux évaluateurs (junior et senior) sont considérés comme des échantillons aléatoires d’une population plus large d’évaluateurs possibles.</p></li>
<li><p>Absolute agreement : on s’intéresse à l’accord absolu entre les évaluateurs, pas seulement à la corrélation.</p></li>
<li><p>Single rater/measurement : on considère les notes individuelles de chaque évaluateur, pas une moyenne.</p></li>
</ul>
<p>C’est le type d’ICC le plus couramment utilisé en pratique clinique.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>psy<span class="sc">::</span><span class="fu">icc</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    smp.aij[,<span class="fu">c</span>(<span class="st">"gravite.jun"</span>,<span class="st">"gravite.sen"</span>)]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$nb.subjects
[1] 796

$nb.raters
[1] 2

$subject.variance
[1] 2.4

$rater.variance
[1] -0.000228

$residual
[1] 0.257

$icc.consistency
[1] 0.903

$icc.agreement
[1] 0.903</code></pre>
</div>
</div>
<ul>
<li><p><code>$subject.variance</code> : variance sujets = variance signal</p></li>
<li><p><code>$rater.variance</code> : variance évaluateurs = variance bruit due aux différences entre évaluateurs</p></li>
<li><p><code>$residual</code> : variance résiduelle = variance bruit due aux autres sources d’erreur</p></li>
<li><p><code>$icc.agreement</code> : coefficient de corrélation intraclasse ICC vaut 0,9</p></li>
</ul>
<p>Mais la librarie <code>irr</code> propose aussi une fonction <code>icc()</code> pour calculer le coefficient de corrélation intraclasse, il faut juste la paramétrer un peu plus mais l’output est plus clair.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lpSolve</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'irr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:psy':

    icc</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>irr<span class="sc">::</span><span class="fu">icc</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    smp.aij[,<span class="fu">c</span>(<span class="st">"gravite.jun"</span>,<span class="st">"gravite.sen"</span>)],</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">model=</span><span class="st">"twoway"</span>, <span class="co"># sinon oneway si un seul évaluateur par sujet</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">"agreement"</span>, <span class="co"># sinon consistency = uniformité des réponses</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">unit=</span><span class="st">"single"</span> <span class="co"># single ou average</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Single Score Intraclass Correlation

   Model: twoway 
   Type : agreement 

   Subjects = 796 
     Raters = 2 
   ICC(A,1) = 0.903

 F-Test, H0: r0 = 0 ; H1: r0 &gt; 0 
 F(795,795) = 19.7 , p = 5.62e-295 

 95%-Confidence Interval for ICC Population Values:
  0.89 &lt; ICC &lt; 0.915</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="résumé-des-paramètres-de-dépendance-entre-deux-variables-quantitatives" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="résumé-des-paramètres-de-dépendance-entre-deux-variables-quantitatives"><span class="header-section-number">5.1.4</span> Résumé des paramètres de dépendance entre deux variables quantitatives</h3>
<p>Résumé des principaux paramètres de dépendance entre deux variables quantitatives :</p>
<ul>
<li><p>Dépendance</p></li>
<li><p>Dépendance monotone ou linéaire</p>
<ul>
<li><p>Coefficient de corrélation de Pearson</p></li>
<li><p>Coefficient de détermination = variance partagée (≠ covariance)</p></li>
</ul></li>
<li><p>Concordance = coefficient de corrélation intraclasse (ICC)</p></li>
</ul>
<hr>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 49%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Paramètre</th>
<th>Symbole</th>
<th>Interprétation</th>
<th>Formule / calcul R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Coefficient de corrélation</td>
<td><span class="math inline">\(r\)</span> ou <span class="math inline">\(\rho\)</span></td>
<td>Direction et force de la relation linéaire entre deux variables quantitatives</td>
<td><code>cor(X, Y)</code></td>
</tr>
<tr class="even">
<td>Variance partagée</td>
<td><span class="math inline">\(r^2\)</span></td>
<td>Proportion de la variance de <span class="math inline">\(Y\)</span> expliquée par <span class="math inline">\(X\)</span> (force de la relation linéaire)</td>
<td><code>rho2 &lt;- cor(X, Y)^2</code></td>
</tr>
<tr class="odd">
<td>Covariance</td>
<td><span class="math inline">\(\mathrm{Cov}(X,Y)\)</span></td>
<td>Mesure comment deux variables varient ensemble (positive : ensemble, négative : sens inverse)</td>
<td><code>cov(X, Y)</code></td>
</tr>
<tr class="even">
<td>Coefficient de corrélation intraclasse</td>
<td>ICC</td>
<td>Mesure la concordance entre plusieurs mesures quantitatives</td>
<td><code>psy::icc(dataframe)</code> ou <code>irr::icc(dataframe, model=..., type=..., unit=...)</code></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="variables-catégorielles" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="variables-catégorielles"><span class="header-section-number">5.2</span> Variables catégorielles</h2>
<section id="dépendance-1" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="dépendance-1"><span class="header-section-number">5.2.1</span> Dépendance</h3>
<section id="chi2-et-associés" class="level4" data-number="5.2.1.1">
<h4 data-number="5.2.1.1" class="anchored" data-anchor-id="chi2-et-associés"><span class="header-section-number">5.2.1.1</span> Chi2 et associés</h4>
<ul>
<li><p>Existe-t-il une relation entre les deux variables catégorielles ?</p></li>
<li><p>Si oui, quelle est la force de cette relation ?</p></li>
</ul>
<p>Pour ces questions : on utilise</p>
<ul>
<li><strong>Le test du Chi2 d’indépendance</strong> sert à évaluer l’existence d’une relation entre deux variables catégorielles.</li>
</ul>
<p>Et des transformations normalisées du Chi2 pour évaluer la force de cette relation :</p>
<p><em>(pour normaliser le Chi2 : racine carré de chi2/nombre d’observations)</em></p>
<ul>
<li><p><strong>Le V de Cramer</strong> pour la force de l’association entre deux variables catégorielles <strong>non ordonnées</strong> (type de chirurgie) (= on pourrait utiliser le coefficient de Pearson pour des variables binaires).</p>
<ul>
<li>Varie entre 0 (pas d’association) et 1 (association parfaite)</li>
</ul></li>
<li><p>Le coefficient de Pearson : plutôt pour variables quantitatives, mais utilisable pour des variables binaires (0/1)</p>
<ul>
<li>Varie entre -1 et +1</li>
</ul></li>
<li><p><strong>Le coefficient de Spearman</strong> : pour variables <strong>ordinales</strong> ou quantitatives non linéaires (rangées)</p>
<ul>
<li><p>Coefficient de Spearman = corrélation de Pearson calculée sur les rangs des données</p></li>
<li><p>Varie entre -1 et +1</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>ANOVA ou V de Cramer pour variables catégorielles non ordonnées ?</strong></p>
<ul>
<li><p><strong>ANOVA</strong> :</p>
<ul>
<li><p>1 variable quantitative, 1 ou plusieurs variables catégorielles non ordonnées</p></li>
<li><p>compare les moyennes de la variable quantitative entre les différentes modalités de la variable catégorielle</p></li>
<li><p>test statistique (p-value)</p></li>
<li><p>outcome quantitatif</p></li>
</ul></li>
<li><p><strong>V de Cramer</strong> :</p>
<ul>
<li><p>Variables catégorielles non ordonnées</p></li>
<li><p>mesure la force de l’association entre les variables</p></li>
<li><p>valeur entre 0 et 1</p></li>
<li><p>outcome catégoriel</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="odds-ratio-et-risque-relatif" class="level4" data-number="5.2.1.2">
<h4 data-number="5.2.1.2" class="anchored" data-anchor-id="odds-ratio-et-risque-relatif"><span class="header-section-number">5.2.1.2</span> Odds-ratio et risque relatif</h4>
<p>Pour des X et Y binaires (0/1) :</p>
<p>Exemple : association entre décès en USI et existence d’une infection ou non</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Décès (Y=1)</th>
<th>Pas de décès (Y=0)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Infection (X=1)</td>
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td>Pas d’infection(X=0)</td>
<td>c</td>
<td>d</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Risque relatif (RR)</strong> = risque de décès chez les patients infectés / risque de décès chez les patients non infectés = [a/(a+b)] / [c/(c+d)]</p>
<ul>
<li><p>On a RR fois plus de risque de décès si on est infecté</p></li>
<li><p><span class="math inline">\(RR = \frac{\text{\% de deces chez les infectes}}{\text{\% de deces chez les non infectes}} = \frac{a}{a+b} / \frac{c}{c+d}\)</span></p></li>
</ul></li>
<li><p><strong>Odds-ratio (OR)</strong> = rapports des côtes = interprétation plus subtile</p>
<ul>
<li><p>Odds de décès chez les patients infectés = a/b (côte)</p></li>
<li><p>Odds de décès chez les patients non infectés = c/d</p></li>
<li><p><span class="math inline">\(OR = \frac{\dfrac{\text{morts infectes}}{\text{vivants infectes}}}{\dfrac{\text{morts non infectes}}{\text{vivants non infectes}}} = \frac{\frac{a}{b}}{\frac{c}{d}} = \frac{a \times d}{b \times c}\)</span></p></li>
<li><p>Il y a OR fois plus de “morts par rapport aux vivants” si on est infecté que de “morts par rapport aux vivants” si on n’est pas infecté.</p></li>
</ul></li>
</ul>
<p>RR et OR sont positifs et varient de 0 à l’infini.</p>
<p>S’ils valent 1 : pas d’association entre X et Y, les variables sont indépendantes.</p>
<p>S’ils valent 0 ou sont très grands : forte association entre X et Y.</p>
<p><strong>Rapport entre RR et OR :</strong></p>
<ul>
<li><p>Si l’événement étudié est rare (&lt;10%) : RR ≈ OR</p></li>
<li><p>Si l’événement est fréquent (&gt;10%) : <strong>OR surestime le RR</strong> (OR &gt; RR si RR &gt; 1 ; OR &lt; RR si RR &lt; 1)</p></li>
</ul>
</section>
<section id="exemple-sur-r-3" class="level4" data-number="5.2.1.3">
<h4 data-number="5.2.1.3" class="anchored" data-anchor-id="exemple-sur-r-3"><span class="header-section-number">5.2.1.3</span> Exemple sur R</h4>
<p>Sur fichier <code>smp.d</code> : force de l’association entre la variable “dépression” (<code>smp.d$depression</code>) et le FDR “le prisonnier a un niveau élevé d’évitement du danger” (<code>smp.d$evit.danger</code>).</p>
<p>La variable dépression est binaire (0 = non dépressif, 1 = dépressif).</p>
<p>La variable evit.danger n’est pas binaire, mais codée 1, 2 ou 3 pour “faible”, “moyen” ou “élevé”.</p>
<p>Il faut donc la recoder en binaire (0 = faible ou moyen, 1 = élevé).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>smp.d<span class="sc">$</span>evit.danger.b <span class="ot">&lt;-</span> smp.d<span class="sc">$</span>evit.danger <span class="sc">&gt;</span> <span class="dv">2</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>smp.d<span class="sc">$</span>depression.b <span class="ot">&lt;-</span> smp.d<span class="sc">$</span>depression <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>        smp.d<span class="sc">$</span>depression.b, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        smp.d<span class="sc">$</span>evit.danger.b, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">deparse.level=</span><span class="dv">2</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>tb</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  smp.d$evit.danger.b
smp.d$depression.b FALSE TRUE
             FALSE   338   96
             TRUE    131  126</code></pre>
</div>
</div>
<p>Pour obtenir facilement le RR et l’OR, on peut utiliser la fonction <code>epi.2by2()</code> du package <code>epiR</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.2by2</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    tb,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"cohort.count"</span>, <span class="co"># sinon case.control</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.level=</span><span class="fl">0.95</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Outcome+    Outcome-      Total                 Inc risk *
Exposure+         338          96        434     77.88 (73.68 to 81.70)
Exposure-         131         126        257     50.97 (44.69 to 57.24)
Total             469         222        691     67.87 (64.25 to 71.34)

Point estimates and 95% CIs:
-------------------------------------------------------------------
Inc risk ratio                                 1.53 (1.34, 1.74)
Inc odds ratio                                 3.39 (2.43, 4.73)
Attrib risk in the exposed *                   26.91 (19.65, 34.16)
Attrib fraction in the exposed (%)            34.55 (25.88, 42.85)
Attrib risk in the population *                16.90 (9.87, 23.93)
Attrib fraction in the population (%)         24.90 (19.77, 30.45)
-------------------------------------------------------------------
Uncorrected chi2 test that OR = 1: chi2(1) = 53.594 Pr&gt;chi2 = &lt;0.001
Fisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001
 Wald confidence limits
 CI: confidence interval
 * Outcomes per 100 population units </code></pre>
</div>
</div>
</section>
</section>
<section id="dépendance-monotone" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="dépendance-monotone"><span class="header-section-number">5.2.2</span> Dépendance monotone</h3>
<p>Une dépendance monotone ne peut s’envisager qu’entre des variables ordinales (rangées) ou entre une variable ordinale et une variable quantitative.</p>
<ul>
<li><p><strong>Coefficient de Spearman</strong> : corrélation de Pearson calculée sur les rangs des données.</p>
<ul>
<li><p>Varie entre -1 et +1</p></li>
<li><p>Utilisable pour des variables ordinales (rangées) ou quantitatives non linéaires</p></li>
</ul></li>
</ul>
<p>Problème : donner du sens à une corrélation basée sur des rangs !! dépend ++ du codage</p>
<section id="exemple-sur-r-4" class="level4" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="exemple-sur-r-4"><span class="header-section-number">5.2.2.1</span> Exemple sur R</h4>
<p>En pratique : dans l’étude santé mentale en prison, les deux variables de tempérament : « recherche de nouveauté » et « évitement du danger » sont codées en 1, 2 et 3 pour, respectivement, « bas », « moyen » et « élevé ». Si l’on souhaite apprécier dans quelle mesure un niveau élevé de recherche de nouveauté est associé à un niveau bas d’évitement du danger, il est possible d’estimer un coefficient de corrélation de Spearman ou de Pearson :</p>
<p>Dans l’étude <code>smp</code> : variable “recherche de nouveauté” (<code>smp.d$recherche.nouv</code>) et variable “évitement du danger” (<code>smp.d$evit.danger</code>).</p>
<ul>
<li><p>les deux variables <code>recherche.nouv</code> et <code>evit.danger</code> sont codées 1, 2 ou 3 pour “faible”, “moyen” ou “élevé”.</p></li>
<li><p>objectif : apprécier dans quelle mesure un niveau élevé de recherche de nouveauté est associé à un niveau bas d’évitement du danger.</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(smp<span class="sc">$</span>recherche.nouv)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3 
249 157 289 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(smp<span class="sc">$</span>evit.danger)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3 
315 154 222 </code></pre>
</div>
</div>
<p>Calcul du coefficient de corrélation de Spearman entre les deux variables.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    smp.d<span class="sc">$</span>recherche.nouv, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    smp.d<span class="sc">$</span>evit.danger, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"spearman"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">use=</span><span class="st">"complete.obs"</span>) <span class="co"># ignore les valeurs manquantes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0785</code></pre>
</div>
</div>
<p>Le coefficient de corrélation de Spearman est de 0.078, ce qui indique une très faible dépendance monotone positive entre la recherche de nouveauté et l’évitement du danger.</p>
<p>NB : si on avait utilisé le coefficient de Pearson :</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    smp.d<span class="sc">$</span>recherche.nouv, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    smp.d<span class="sc">$</span>evit.danger, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"pearson"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">use=</span><span class="st">"complete.obs"</span>) <span class="co"># ignore les valeurs manquantes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0807</code></pre>
</div>
</div>
<p>Le coefficient de corrélation de Pearson est de 0.081 : les deux coefficients sont très proches (c’est assez fréquent quand les variables sont ordinales avec peu de modalités).</p>
</section>
</section>
<section id="concordance-1" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="concordance-1"><span class="header-section-number">5.2.3</span> Concordance</h3>
<section id="coefficient-kappa-de-cohen" class="level4" data-number="5.2.3.1">
<h4 data-number="5.2.3.1" class="anchored" data-anchor-id="coefficient-kappa-de-cohen"><span class="header-section-number">5.2.3.1</span> Coefficient kappa de Cohen</h4>
<p>Pour les variables catégorielles, on pourrait se dire que mesurer à quel point 2 variables s’accordent reviendraient à compter la proportion de fois ou elles ont la même valeur.</p>
<p>Problème : cette proportion de concordance peut être due au hasard !!</p>
<p>On corrige ça avec le <strong>kappa de Cohen</strong>.<br>
</p>
<p><span class="math display">\[
\text{kappa} = \frac{\text{concordance observee - concordance due au hasard}}{1 - \text{concordance due au hasard}}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\text{kappa} = 0\)</span> : concordance observée = concordance due au hasard</p></li>
<li><p><span class="math inline">\(\text{kappa} = 1\)</span> : concordance parfaite</p></li>
</ul>
</section>
<section id="sensibilité-spécificité-vpp-vpn" class="level4" data-number="5.2.3.2">
<h4 data-number="5.2.3.2" class="anchored" data-anchor-id="sensibilité-spécificité-vpp-vpn"><span class="header-section-number">5.2.3.2</span> Sensibilité, spécificité, VPP, VPN</h4>
<p>Le kappa de Cohen mesure une <strong>concordance globale et symétrique</strong> entre deux variables catégorielles.</p>
<p>Mais parfois, on s’intéresse à la capacité d’une variable à s’approcher d’ue variable de référence</p>
<p>= mesurer à quel point <span class="math inline">\(Y\)</span> prédit correctement <span class="math inline">\(X\)</span>.</p>
<p>Dans ce cas, il vaut mieux utiliser des paramètres asymétriques :</p>
<ul>
<li><p>Sensibilité = proportion de vrais positifs parmi les positifs réels = <span class="math inline">\(P(Y=1|X=1)\)</span></p></li>
<li><p>Spécificité = proportion de vrais négatifs parmi les négatifs réels = <span class="math inline">\(P(Y=0|X=0)\)</span></p></li>
</ul>
<p>Le problème avec la sensibilité et la spécificité : elles ne tiennent pas compte de la prévalence de la condition réelle <span class="math inline">\(X\)</span> (c’est à dire la proportion de <span class="math inline">\(X=1\)</span> dans la population).</p>
<ul>
<li><p>Valeur prédictive positive (VPP) = proportion de vrais positifs parmi les positifs prédits = <span class="math inline">\(P(X=1|Y=1)\)</span></p></li>
<li><p>Valeur prédictive négative (VPN) = proportion de vrais négatifs parmi les négatifs prédits = <span class="math inline">\(P(X=0|Y=0)\)</span></p></li>
</ul>
<p>Dans un tableau de contingence :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 34%">
<col style="width: 32%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Y=1 (test positif)</th>
<th>Y=0 (test négatif)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X=1 (condition réelle présente)</td>
<td>a (vrais positifs)</td>
<td>b (faux négatifs)</td>
</tr>
<tr class="even">
<td>X=0 (condition réelle absente)</td>
<td>c (faux positifs)</td>
<td>d (vrais négatifs)</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Sensibilité = a / (a + b)</p></li>
<li><p>Spécificité = d / (c + d)</p></li>
<li><p>Valeur prédictive positive (VPP) = a / (a + c)</p></li>
<li><p>Valeur prédictive négative (VPN) = d / (b + d)</p></li>
</ul>
<p>On peut ainsi représenter une courbe ROC (Receiver Operating Characteristic) qui trace la sensibilité en fonction de 1 - spécificité pour différents seuils de décision.</p>
<section id="exemple-1-sur-r" class="level5" data-number="5.2.3.2.1">
<h5 data-number="5.2.3.2.1" class="anchored" data-anchor-id="exemple-1-sur-r"><span class="header-section-number">5.2.3.2.1</span> Exemple 1 sur R</h5>
<ul>
<li><p>Les deux cliniciens (junior et senior) posent un diagnostic de schizophrénie (1 = oui, 0 = non) pour chaque patient.</p></li>
<li><p>Niveau d’accord inter-juges pour une variable catégorielle : kappa de Cohen.</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>psy<span class="sc">::</span><span class="fu">ckappa</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    smp.aij[,<span class="fu">c</span>(<span class="st">"scz.jun"</span>,<span class="st">"scz.sen"</span>)]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$table
    0  1
0 715 11
1  30 43

$kappa
[1] 0.65</code></pre>
</div>
</div>
<p>Autre méthode avec le package <code>irr</code> :</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>irr<span class="sc">::</span><span class="fu">kappa2</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    smp.aij[,<span class="fu">c</span>(<span class="st">"scz.jun"</span>,<span class="st">"scz.sen"</span>)],</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight=</span><span class="st">"unweighted"</span> <span class="co"># ou "equal" ou "squared" pour kappa pondéré</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Cohen's Kappa for 2 Raters (Weights: unweighted)

 Subjects = 799 
   Raters = 2 
    Kappa = 0.65 

        z = 18.6 
  p-value = 0 </code></pre>
</div>
</div>
<p>Le clinicien junior a posé le diagnostic de schizophrénie chez 30 + 43 = 73 détenus alors que le clinicien senior l’a fait pour seulement 11 + 43 = 54.</p>
<p>Au total, le coefficient kappa vaut 0,65.</p>
</section>
<section id="exemple-2-sur-r" class="level5" data-number="5.2.3.2.2">
<h5 data-number="5.2.3.2.2" class="anchored" data-anchor-id="exemple-2-sur-r"><span class="header-section-number">5.2.3.2.2</span> Exemple 2 sur R</h5>
<ul>
<li><p>Étude sur 244 patients déprimés hospitalisés : tâche de lecture de texte puis comptage de 1 à 10, enregistrement voix.</p></li>
<li><p>Extraction de la fréquence fondamentale (hauteur de voix), connue pour être ~75–140 Hz chez les hommes et ~170–250 Hz chez les femmes.</p></li>
<li><p>Objectif : voir dans quelle mesure la hauteur de voix prédit le sexe en testant un seuil de 155 Hz.</p></li>
<li><p>Méthode : <strong>calcul sensibilité et spécificité du seuil 155 Hz</strong> pour discriminer hommes et femmes.</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sexe.f <span class="ot">&lt;-</span> vox<span class="sc">$</span>sexe <span class="sc">==</span> <span class="dv">2</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>voix.aigue <span class="ot">&lt;-</span> vox<span class="sc">$</span>moyf0<span class="sc">&gt;</span><span class="dv">155</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># moyenne des femmes avec voix aiguë = sensibilité</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># = proportion de femmes avec test positif</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(voix.aigue[sexe.f], <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.917</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># moyenne des hommes sans voix aiguë = spécificité </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># = proportion d'hommes avec test négatif</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="sc">!</span>voix.aigue[<span class="sc">!</span>sexe.f], <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.933</code></pre>
</div>
</div>
<p>Vérifier le seuil de 155 Hz avec une courbe ROC :</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>rocf0 <span class="ot">&lt;-</span> <span class="fu">roc</span>(sexe.f<span class="sc">~</span>vox<span class="sc">$</span>moyf0)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = FALSE, case = TRUE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rocf0, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">"Courbe ROC pour la hauteur de voix"</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">print.thres=</span><span class="st">"best"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">print.thres.best.method=</span><span class="st">"youden"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">print.auc=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_resume_statistique_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Seuil optimal calculé par indice de Youden (maximise la somme de la sensibilité et de la spécificité) = 158,17 Hz</p>
<p>AUC : calcule la qualité globale du test</p>
<ul>
<li><p>Aire comprise entre 0 et 1</p></li>
<li><p>= probabilité que la hauteur de voix d’une femme soit plus élevée que celle d’un homme pris au hasard</p></li>
</ul>


</section>
</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Mes notes de cours">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Mes notes de cours</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./6_effet_centre.html" class="pagination-link" aria-label="6 Effet centre">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">6 Effet centre</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>