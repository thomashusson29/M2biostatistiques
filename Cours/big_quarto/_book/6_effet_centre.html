<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; 6 Effet centre – Mes notes de cours</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./1_resume_statistique.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-99913b7803b80b0c1d2b970a25816663.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./6_effet_centre.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">6 Effet centre</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mes notes de cours</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Mes notes de cours</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_resume_statistique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Résumé statistique</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_effet_centre.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">6 Effet centre</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4</span> Introduction</a></li>
  <li><a href="#modèle-linéaire" id="toc-modèle-linéaire" class="nav-link" data-scroll-target="#modèle-linéaire"><span class="header-section-number">5</span> Modèle linéaire</a>
  <ul>
  <li><a href="#analyse-naïve-sans-prise-en-compte-du-centre" id="toc-analyse-naïve-sans-prise-en-compte-du-centre" class="nav-link" data-scroll-target="#analyse-naïve-sans-prise-en-compte-du-centre"><span class="header-section-number">5.1</span> Analyse naïve sans prise en compte du centre</a>
  <ul>
  <li><a href="#problèmes-posés-par-cette-analyse-naïve" id="toc-problèmes-posés-par-cette-analyse-naïve" class="nav-link" data-scroll-target="#problèmes-posés-par-cette-analyse-naïve"><span class="header-section-number">5.1.1</span> Problèmes posés par cette analyse naïve</a></li>
  <li><a href="#exemple-r-avec-jeu-de-données-fictif" id="toc-exemple-r-avec-jeu-de-données-fictif" class="nav-link" data-scroll-target="#exemple-r-avec-jeu-de-données-fictif"><span class="header-section-number">5.1.2</span> Exemple R avec jeu de données fictif</a></li>
  </ul></li>
  <li><a href="#analyse-avec-prise-en-compte-de-leffet-centre" id="toc-analyse-avec-prise-en-compte-de-leffet-centre" class="nav-link" data-scroll-target="#analyse-avec-prise-en-compte-de-leffet-centre"><span class="header-section-number">5.2</span> Analyse avec prise en compte de l’effet centre</a>
  <ul>
  <li><a href="#exemple-r" id="toc-exemple-r" class="nav-link" data-scroll-target="#exemple-r"><span class="header-section-number">5.2.1</span> Exemple R</a></li>
  </ul></li>
  <li><a href="#analyse-intra-centres-modèles-conditionnels-mixtes-ou-non" id="toc-analyse-intra-centres-modèles-conditionnels-mixtes-ou-non" class="nav-link" data-scroll-target="#analyse-intra-centres-modèles-conditionnels-mixtes-ou-non"><span class="header-section-number">5.3</span> Analyse intra-centres (modèles conditionnels, mixtes ou non)</a>
  <ul>
  <li><a href="#modèle-linéaire-avec-effet-fixe-par-centre" id="toc-modèle-linéaire-avec-effet-fixe-par-centre" class="nav-link" data-scroll-target="#modèle-linéaire-avec-effet-fixe-par-centre"><span class="header-section-number">5.3.1</span> Modèle linéaire avec effet fixe par centre</a></li>
  <li><a href="#modèle-linéaire-avec-pente-commune-intercept-variable-par-centre" id="toc-modèle-linéaire-avec-pente-commune-intercept-variable-par-centre" class="nav-link" data-scroll-target="#modèle-linéaire-avec-pente-commune-intercept-variable-par-centre"><span class="header-section-number">5.3.2</span> Modèle linéaire avec pente commune (intercept variable par centre)</a></li>
  <li><a href="#modèle-mixte-avec-effet-aléatoire-de-centre" id="toc-modèle-mixte-avec-effet-aléatoire-de-centre" class="nav-link" data-scroll-target="#modèle-mixte-avec-effet-aléatoire-de-centre"><span class="header-section-number">5.3.3</span> Modèle mixte avec effet aléatoire de centre</a></li>
  <li><a href="#exemple-r-1" id="toc-exemple-r-1" class="nav-link" data-scroll-target="#exemple-r-1"><span class="header-section-number">5.3.4</span> Exemple R</a></li>
  <li><a href="#conditions-de-validités-des-modèles-mixtes" id="toc-conditions-de-validités-des-modèles-mixtes" class="nav-link" data-scroll-target="#conditions-de-validités-des-modèles-mixtes"><span class="header-section-number">5.3.5</span> Conditions de validités des modèles mixtes</a></li>
  </ul></li>
  <li><a href="#modèle-marginal-gee-generalized-estimating-equations" id="toc-modèle-marginal-gee-generalized-estimating-equations" class="nav-link" data-scroll-target="#modèle-marginal-gee-generalized-estimating-equations"><span class="header-section-number">5.4</span> Modèle marginal = GEE (Generalized Estimating Equations)</a>
  <ul>
  <li><a href="#définition" id="toc-définition" class="nav-link" data-scroll-target="#définition"><span class="header-section-number">5.4.1</span> Définition</a></li>
  <li><a href="#principe-des-gee" id="toc-principe-des-gee" class="nav-link" data-scroll-target="#principe-des-gee"><span class="header-section-number">5.4.2</span> Principe des GEE</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#modèle-linéaire-généralisé" id="toc-modèle-linéaire-généralisé" class="nav-link" data-scroll-target="#modèle-linéaire-généralisé"><span class="header-section-number">6</span> Modèle linéaire généralisé</a>
  <ul>
  <li><a href="#principes-généraux" id="toc-principes-généraux" class="nav-link" data-scroll-target="#principes-généraux"><span class="header-section-number">6.1</span> Principes généraux</a></li>
  <li><a href="#exemple-r-avec-données-simulées" id="toc-exemple-r-avec-données-simulées" class="nav-link" data-scroll-target="#exemple-r-avec-données-simulées"><span class="header-section-number">6.2</span> Exemple R avec données simulées</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">6 Effet centre</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div style="page-break-after: always;"></div>
<section id="introduction" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Introduction</h1>
<p>Les mesures répétées désignent des situations où plusieurs observations sont recueillies sur une même unité statistique (souvent un patient) au cours du temps, ou lorsque les observations sont regroupées au sein de clusters (par exemple, des patients au sein d’un même hôpital ou des membres d’une même famille).</p>
<p>Le défi majeur posé par ces données réside dans la non-indépendance des observations.</p>
<p>En effet, les mesures effectuées sur un même patient à différents moments sont généralement corrélées entre elles.</p>
<p>Ignorer cette corrélation en utilisant des méthodes statistiques classiques (comme la régression linéaire standard ou l’ANOVA classique) viole l’hypothèse d’indépendance des résidus, conduisant à des estimations biaisées de la précision (intervalles de confiance trop étroits) et à une augmentation du risque d’erreur de type I.</p>
<p>Si l’analyse est relativement simple avec seulement deux points de mesure (analyse de l’évolution <span class="math inline">\(Y_{après} - Y_{avant}\)</span> ou ajustement sur la valeur basale), elle devient plus complexe avec trois mesures ou plus.</p>
</section>
<section id="modèle-linéaire" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Modèle linéaire</h1>
<p>Imaginons qu’on corrèle la durée d’entretien (en minutes) <span class="math inline">\(Y\)</span> avec le niveau de dépression <span class="math inline">\(X\)</span>.</p>
<p><span class="math inline">\(Y\)</span> est supposé normalement distribué.</p>
<p><span class="math inline">\(X\)</span> est supposé quantitatif.</p>
<p>Corrélation : peut être intra- ou inter-centre</p>
<ul>
<li><p>Intra-centre : rechercher si un sujet avec un niveau de dépression <span class="math inline">\(X\)</span> élevé a une durée d’entretien <span class="math inline">\(Y\)</span> supérieure à celle d’un autre sujet du même centre présentant un niveau de dépression plus bas.</p></li>
<li><p>Inter-centre : la durée moyenne des entretiens <span class="math inline">\(\hat{Y}\)</span> réalisés dans les prisons avec un haut niveau de dépression est-elle supérieure ou inférieure à la durée moyenne des entretiens réalisés dans les autres prisons ?</p></li>
</ul>
<section id="analyse-naïve-sans-prise-en-compte-du-centre" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="analyse-naïve-sans-prise-en-compte-du-centre"><span class="header-section-number">5.1</span> Analyse naïve sans prise en compte du centre</h2>
<p>Imaginons qu’on néglige l’effet centre et qu’on réalise une régression linéaire simple de <span class="math inline">\(Y\)</span> en fonction de <span class="math inline">\(X\)</span>..</p>
<p>On prend 3 centres comprenanant chacun 9 détenus.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-68.png" class="img-fluid figure-img" width="468"></p>
<figcaption>Estimation d’une corrélation entre « durée de l’entretien » et «score de dépression » sans tenir compte de l’effet centre (ici un centre par couleur). La droite de régression minimise la somme des <span class="math inline">\(\varepsilon_i^2\)</span> et néglige l’effet centre.</figcaption>
</figure>
</div>
<p>Ici :</p>
<ul>
<li><p>Effet centre particulièrement important</p></li>
<li><p>Chaque centre semble associé à un niveau spécifique de dépression <span class="math inline">\(\hat{X}\)</span></p></li>
<li><p>Et à un niveau moyen spécifique de durée d’entretien <span class="math inline">\(\hat{Y}\)</span></p></li>
</ul>
<section id="problèmes-posés-par-cette-analyse-naïve" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="problèmes-posés-par-cette-analyse-naïve"><span class="header-section-number">5.1.1</span> Problèmes posés par cette analyse naïve</h3>
<p>= biais de confusion par effet de groupe + non-indépendance des résidus</p>
<p><strong>Problème 1 : Biais de confusion par effet de groupe.</strong></p>
<ul>
<li><p>Si les centres pour lesquels le niveau de dépression est le plus élevé sont aussi ceux où la durée moyenne des entretiens est la plus longue, la pente de régression est <strong>biaisée</strong>.</p></li>
<li><p>Elle mélange l’effet individuel (la relation durée-dépression pour un détenu) et l’effet du groupe. Le modèle ne peut distinguer si la dépression est liée à la durée de l’entretien ou à d’autres facteurs propres au centre (personnel, type de population, etc.).</p></li>
<li><p><em>Conséquence :</em> Le coefficient de régression estimé est faussé et ne représente pas la véritable association au niveau individuel.</p></li>
</ul>
<p><strong>Problème 2 : Non-indépendance des résidus.</strong></p>
<ul>
<li><p>Les résidus <span class="math inline">\(\varepsilon_i\)</span> ne sont pas indépendants. Les observations au sein d’un même groupe (centre) se ressemblent plus qu’avec celles d’autres groupes.</p></li>
<li><p>C’est la <strong>corrélation intra-classe</strong>.</p></li>
<li><p><em>Conséquence :</em> Ce problème ne biaise pas l’estimation de la pente, mais il conduit à une <strong>sous-estimation de son erreur-standard</strong>.</p></li>
<li><p><em>Impact :</em> L’intervalle de confiance est artificiellement étroit et la p-value trop petite. Le risque est de conclure à tort à un effet significatif (Erreur de Type I).</p></li>
<li><p><strong>Solutions : Bootstrap par grappe ou estimateur sandwich</strong></p>
<ul>
<li><p><strong>Le Bootstrap par grappe (Cluster Bootstrap) :</strong></p>
<ul>
<li><p><em>Principe :</em></p>
<ul>
<li><p>Puisque les individus d’un groupe ne sont pas indépendants, on ré-échantillonne les <strong>groupes</strong> (les centres) avec remise.</p></li>
<li><p>Pour chaque groupe tiré, on inclut tous les individus qu’il contient.</p></li>
</ul></li>
<li><p><em>Résultat :</em></p>
<ul>
<li><p>On obtient une distribution de 1000 coefficients qui reflète l’incertitude liée à la variabilité <em>entre les groupes</em>. L’IC à 95% est construit à partir de cette distribution (ex: via les percentiles).</p></li>
<li><p><strong>Cet intervalle sera presque toujours plus large</strong> que l’IC naïf, reflétant une estimation plus honnête de l’incertitude.<br>
</p></li>
</ul></li>
</ul></li>
<li><p><strong>L’estimateur “Sandwich” (Estimateur Robuste de la Variance) :</strong></p>
<ul>
<li><p><strong>Le problème :</strong></p>
<ul>
<li><p>Le modèle classique est “trop confiant”. Il pense que chaque ligne de données apporte une information unique.</p></li>
<li><p>Or, si les patients d’un même centre se ressemblent, on a moins d’information réelle qu’on ne le croit.</p></li>
<li><p>L’erreur-standard calculée classiquement est donc trop petite.<br>
</p></li>
</ul></li>
<li><p><strong>Solution</strong> :</p>
<ul>
<li><p>Au lieu de se fier uniquement à la théorie (qui suppose l’indépendance), l’estimateur Sandwich regarde les résidus réels (les erreurs du modèle).</p></li>
<li><p>Si, dans un centre, tous les résidus vont dans le même sens (ex: le modèle se trompe toujours par excès pour ce centre), l’estimateur détecte cette corrélation. Il utilise cette “réalité du terrain” pour corriger mathématiquement la variance à la hausse.<br>
</p></li>
</ul></li>
<li><p><strong>Principe :</strong> La formule mathématique de la variance robuste se compose de trois blocs multipliés entre eux : <span class="math inline">\(A \times B \times A\)</span>.</p></li>
<li><p>On l’appelle “Sandwich” uniquement parce que la correction (B) est coincée entre deux blocs identiques (A), comme une tranche de jambon entre deux tranches de pain.</p>
<ol type="1">
<li><p><strong>Le bloc A (La Théorie) :</strong> C’est la variance calculée par le modèle classique. Elle suppose que tout est parfait (indépendance).</p></li>
<li><p><strong>Le bloc B (La Réalité) :</strong> C’est une correction calculée directement à partir des <strong>données brutes</strong> (les résidus). Si les erreurs sont corrélées dans les groupes, ce bloc B va “gonfler” la valeur.</p></li>
<li><p><strong>Le calcul :</strong> On multiplie <code>Théorie</code> <span class="math inline">\(\times\)</span> <code>Correction</code> <span class="math inline">\(\times\)</span> <code>Théorie</code>.</p></li>
</ol></li>
<li><p><em><strong>Résultat</strong> :</em> Les estimations des coefficients (la pente) ne changent pas, mais les intervalles de confiance s’élargissent et les p-values augmentent, reflétant une incertitude plus honnête.</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="exemple-r-avec-jeu-de-données-fictif" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="exemple-r-avec-jeu-de-données-fictif"><span class="header-section-number">5.1.2</span> Exemple R avec jeu de données fictif</h3>
<ol type="1">
<li>Génération des données</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># génération des Xi et Yi pour 5 temps de mesure dans 200 centres</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">0.3</span> <span class="co"># Génération des xi pour le centre j</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">0.3</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">0.3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">0.3</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">0.3</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="dv">300</span> <span class="co"># Les coefficiens de la régression</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="dv">150</span> <span class="co"># sont fonction du centre</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>x1<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">72.5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>x2<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">72.5</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>x3<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">72.5</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>x4<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">72.5</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>x5<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">72.5</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># dt est le fichier "large" (une ligne par centre)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,x1,y1,x2,y2,x3,y3,x4,y4,x5,y5)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dt)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"centre"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># conversion du fichier "large" en fichier "long"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>dtl <span class="ot">&lt;-</span> <span class="fu">reshape</span>(dt,<span class="at">idvar=</span><span class="st">"centre"</span>,<span class="at">varying=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>,<span class="at">v.names=</span><span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>),<span class="at">timevar =</span> <span class="st">"temps"</span>,<span class="at">direction=</span><span class="st">"long"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>dtl<span class="sc">$</span>centre <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dtl<span class="sc">$</span>centre)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol start="2" type="1">
<li>Régression linéaire simple sans prise en compte de l’effet centre</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mod.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>dtl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.lm)<span class="sc">$</span>coefficients</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error   t value      Pr(&gt;|t|)
(Intercept) 286.6649   8.232679 34.820363 1.591602e-174
x           153.6712  47.571204  3.230341  1.276828e-03</code></pre>
</div>
</div>
<p>Ici, le calcul de l’erreur-standard (l’écart-type) et de la p-value repose sur l’hypothèse que les résidus sont indépendants, ce qui n’est pas le cas.</p>
<p>Impossible de le savoir si on n’a pas d’information sur les données !!</p>
<p>Attention parce que les résidus semblent “normaux” (cf.&nbsp;graphique ci-dessous), cela ne garantit pas leur indépendance.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(mod.lm),<span class="at">main=</span><span class="st">"Histogramme des résidus"</span>,<span class="at">xlab=</span><span class="st">"Résidus"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(mod.lm),<span class="at">main=</span><span class="st">"Q-Q plot des résidus"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(mod.lm))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="6_effet_centre_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Graphique des résidus du modèle linéaire simple sans prise en compte de l’effet centre</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Bootsrap</strong></p>
<p>Il est possible de recourir à un bootstrap pour contourner cette limite, en utilisant la fonction <code>clusbootglm()</code> de la bibliothèque <code>ClusterBootstrap</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ClusterBootstrap"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mod.clusboot <span class="ot">&lt;-</span> <span class="fu">clusbootglm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>dtl,<span class="at">clusterid=</span>centre)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<pre><code>$boot.coefs : 
(Intercept)         x
286.6787            153.6561
$boot.sds
(Intercept)         x
11.03841            50.14656</code></pre>
<p>L’écart type de b = 50,14 (par rapport à 47,57 naïf). Les coefficients ne changent pas.</p>
<p><strong>Estimateur sandwich</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"sandwich"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovCL</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>dtl),<span class="at">cluster=</span><span class="sc">~</span>centre))[<span class="st">"x"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       x 
50.73999 </code></pre>
</div>
</div>
<p>L’estimation de l’erreur type (50.74) est très proche de celle du bootstrap, prenant toujours en compte la dépendance des observations d’un même centre.</p>
</section>
</section>
<section id="analyse-avec-prise-en-compte-de-leffet-centre" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="analyse-avec-prise-en-compte-de-leffet-centre"><span class="header-section-number">5.2</span> Analyse avec prise en compte de l’effet centre</h2>
<p>il s’agit ici de calculer les moyennes de X et Y pour chaque centre puis d’en faire une régression linéaire</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-69.png" class="img-fluid figure-img" width="498"></p>
<figcaption>Estimation d’une pente inter-centres à partir des moyennes de X et Y pour chaque centre.</figcaption>
</figure>
</div>
<section id="exemple-r" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="exemple-r"><span class="header-section-number">5.2.1</span> Exemple R</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#moyenne de Y et X par centre</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ymeans <span class="ot">=</span> <span class="fu">tapply</span>(dtl<span class="sc">$</span>y, dtl<span class="sc">$</span>centre, mean)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>xmeans <span class="ot">=</span> <span class="fu">tapply</span>(dtl<span class="sc">$</span>x, dtl<span class="sc">$</span>centre, mean)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#régression linéaire des moyennes</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ymeans <span class="sc">~</span> xmeans))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ymeans ~ xmeans)

Residuals:
    Min      1Q  Median      3Q     Max 
-309.22  -75.94   -4.72   73.62  308.89 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    268.8       29.6   9.080   &lt;2e-16 ***
xmeans         272.9      190.4   1.434    0.153    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 111.4 on 198 degrees of freedom
Multiple R-squared:  0.01027,   Adjusted R-squared:  0.005276 
F-statistic: 2.055 on 1 and 198 DF,  p-value: 0.1532</code></pre>
</div>
</div>
<p><code>xmeans</code> : fournit une estimation de la pente inter-centres.</p>
<p>Fournit une estimation de la pente inter-centres, avec une erreur type estimée en prenant en compte l’indépendance des centres.</p>
<p>Cela indique comment la moyenne de <span class="math inline">\(Y\)</span> varie d’un centre à l’autre en fonction de la moyenne de <span class="math inline">\(X\)</span> du centre. L’erreur type est ici estimée correctement car on travaille sur les centres (qui sont indépendants entre eux), et non sur les observations répétées.</p>
</section>
</section>
<section id="analyse-intra-centres-modèles-conditionnels-mixtes-ou-non" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="analyse-intra-centres-modèles-conditionnels-mixtes-ou-non"><span class="header-section-number">5.3</span> Analyse intra-centres (modèles conditionnels, mixtes ou non)</h2>
<p>3 méthodes :</p>
<ol type="1">
<li><p>Modèle linéaire avec effet fixe par centre (chaque centre )</p></li>
<li><p>Modèle linéaire avec pente commune (intercept variable par centre)</p></li>
<li><p>Modèle mixte avec effet aléatoire de centre (c’est à dire que les centres sont vus comme un échantillon aléatoire d’une population plus large de centres possibles)</p></li>
</ol>
<section id="modèle-linéaire-avec-effet-fixe-par-centre" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="modèle-linéaire-avec-effet-fixe-par-centre"><span class="header-section-number">5.3.1</span> Modèle linéaire avec effet fixe par centre</h3>
<p>Pour évaluer la corrélation intra-centre entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>, on peut faire une régression linéaire dans chaque centre puis calculer la moyenne des pentes obtenues.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-70.png" class="img-fluid figure-img" width="481"></p>
<figcaption>Approche conditionnelle artisanale pour laquelle une régression est réalisée dans chaque centre, une pente moyenne étant calculée dans un second temps.</figcaption>
</figure>
</div>
<p>C’est une approche “conditionnelle” car chaque pente est calculée “conditionnellement” à un centre donné.</p>
<p>L’équation serait :<br>
</p>
<p><span class="math display">\[
Y_{ij} = a + [a.centre_{j}] + b x_{ij} + [b.centre_{j}] x_{ij} + \varepsilon_{ij}
\]</span></p>
<ul>
<li><p><span class="math inline">\(i\)</span> : individu</p></li>
<li><p><span class="math inline">\(j\)</span> : centre</p></li>
<li><p><span class="math inline">\(a\)</span> : intercept global</p></li>
<li><p><span class="math inline">\(b\)</span> : pente globale</p></li>
<li><p><span class="math inline">\([a.centre_{j}]\)</span> : déviation de l’intercept pour le centre j</p></li>
<li><p><span class="math inline">\([b.centre_{j}]\)</span> : déviation de la pente pour le centre j</p></li>
</ul>
<p>Globalement : ça revient à faire une régression linéaire avec des interactions entre <span class="math inline">\(X\)</span> et le centre.</p>
<p>Donc chaque centre a sa propre droite de régression (intercept et pente différents).</p>
<p>En R simplement : <code>lm(y ~ x * centre)</code>.</p>
</section>
<section id="modèle-linéaire-avec-pente-commune-intercept-variable-par-centre" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="modèle-linéaire-avec-pente-commune-intercept-variable-par-centre"><span class="header-section-number">5.3.2</span> Modèle linéaire avec pente commune (intercept variable par centre)</h3>
<p>Variante plus simple : pente commune</p>
<p>Modèle proposé :<br>
</p>
<p><span class="math display">\[
y_{ij} = a + [a.\text{centre}_j] + b\, x_{ij} + \varepsilon_{ij}
\]</span></p>
<p>Ici :</p>
<ul>
<li><p>chaque centre <span class="math inline">\(j\)</span> a son intercept propre : <span class="math inline">\(a + [a.\text{centre}_j]\)</span></p></li>
<li><p>mais la pente <span class="math inline">\(b\)</span> est identique dans tous les centres</p></li>
</ul>
<p>Graphiquement : toutes les droites sont parallèles (même pente) mais décalées verticalement (intercepts différents).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-71.png" class="img-fluid figure-img" width="481"></p>
<figcaption>Approche conditionnelle avec pente commune, elle correspond au modèle : <span class="math inline">\(y_{ij} = a + [a.\text{centre}_j] + b\, x_{ij} + \varepsilon_{ij}\)</span></figcaption>
</figure>
</div>
<p>En R : <code>lm(y \~ x + centre)</code></p>
<p>Avec 2 trucs importants à savoir sur l’interprétation de b :</p>
<ul>
<li><p><span class="math inline">\(b\)</span> : sorte de moyenne des pentes centre par centre, pondérée par la variance de <span class="math inline">\(x\)</span> dans chaque centre.</p>
<ul>
<li>Donc lié aux pentes que l’on obtiendrait si on faisait une régression séparée dans chaque centre, puis qu’on faisait une moyenne pondérée.</li>
</ul></li>
<li><p>erreur type de <span class="math inline">\(b\)</span> : correcte uniquement si vraiment toutes les pentes sont égales entre centres.</p>
<ul>
<li><p>Si en réalité les pentes diffèrent un peu entre centres, mais que le modèle force une pente commune, alors :</p>
<ul>
<li><p><span class="math inline">\(b\)</span> reste un estimateur moyen</p></li>
<li><p>mais l’incertitude autour de <span class="math inline">\(b\)</span> est mal évaluée → d’où la suggestion d’utiliser un estimateur sandwich (variance robuste) ou le bootstrap.</p></li>
</ul></li>
</ul></li>
</ul>
<p>Résumé :</p>
<ul>
<li><p>Modèle plus simple, mais repose sur l’hypothèse forte : “même pente partout”.</p></li>
<li><p>Si cette hypothèse est fausse, le <span class="math inline">\(b\)</span> affiché reste “une pente moyenne”, mais son écart-type est trop optimiste.</p></li>
</ul>
</section>
<section id="modèle-mixte-avec-effet-aléatoire-de-centre" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="modèle-mixte-avec-effet-aléatoire-de-centre"><span class="header-section-number">5.3.3</span> Modèle mixte avec effet aléatoire de centre</h3>
<p>Utile surtout si beaucoup de centres.</p>
<p>Passage aux modèles “mixtes” : centre comme effet aléatoire</p>
<p>Idée : plutôt que mettre une variable catégorielle [centre] avec 10 000 modalités, on introduit une variable aléatoire (centre).</p>
<p>Donc la variable catégorielle [centre] devient une variable aléatoire gaussienne (centre).</p>
<p>Nouveau modèle :<br>
</p>
<p><span class="math display">\[
y\_{ij} = a + (a\_{\text{centre}*j}) + b, x*{ij} + \varepsilon\_{ij}
\]</span></p>
<p>Ou :</p>
<ul>
<li><p><span class="math inline">\((a\_{\text{centre}*j})\)</span> : effet aléatoire pour le centre j, c’est à dire une variable aléatoire qui suit une distribution normale et qui modélise la variabilité des intercepts entre centres.</p></li>
<li><p><span class="math inline">\(b\)</span> : pente commune à tous les centres.</p></li>
<li><p><span class="math inline">\(\varepsilon\_{ij}\)</span> : erreur résiduelle pour l’individu i dans le centre j.</p></li>
</ul>
<p>Les effets sont “mixtes” car il y a à la fois des effets fixes (a, b) et des effets aléatoires (a_{*j}).</p>
<p>Ca aide car :</p>
<ul>
<li><p>Pas besoin de 9999 variables binaire (dummy) pour les centres.</p></li>
<li><p>Processus aléatoire pour les centres.</p></li>
</ul>
<p><strong>Il faut le faire surtout s’il y a plus de 5 centres.</strong></p>
<div style="page-break-after: always;"></div>
</section>
<section id="exemple-r-1" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="exemple-r-1"><span class="header-section-number">5.3.4</span> Exemple R</h3>
<p>Calcul des pentes de régressions de <span class="math inline">\(Y\)</span> en fonction de <span class="math inline">\(X\)</span> dans chaque centre</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fonction calculant la pente pour un centre donné</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pente_intra<span class="ot">=</span><span class="cf">function</span>(centre) {<span class="fu">coef</span>(<span class="fu">lm</span>(<span class="at">data=</span>dtl[dtl<span class="sc">$</span>centre<span class="sc">==</span>centre,], y<span class="sc">~</span>x))[<span class="st">"x"</span>]}</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># application de la fonction à tous les centres</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>pentes <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">levels</span>(dtl<span class="sc">$</span>centre), pente_intra) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># affichage de la pente moyenne et de son erreur standard</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La pente moyenne est de"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(pentes), <span class="dv">2</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avec une erreur standard de"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(pentes) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(pentes)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>La pente moyenne est de 131.66 avec une erreur standard de 41.6 </code></pre>
</div>
</div>
<ol type="1">
<li>Modèle avec effet fixe par centre <span class="math inline">\(Y_{ij} = a + [a.centre_{j}] + b x_{ij} + [b.centre_{j}] x_{ij} + \varepsilon_{ij}\)</span></li>
</ol>
<p>C’est surtout le paramètre <span class="math inline">\(b\)</span> qui nous intéresse.</p>
<p>On utilise <code>contr.sum</code> pour que le coefficient <code>x</code> corresponde à la pente MOYENNE de tous les centres (sinon ce serait la pente du centre de référence). Le “point zéro” n’est plus le centre 1 mais la moyenne des centres.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dtlbis <span class="ot">&lt;-</span> dtl</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dtlbis<span class="sc">$</span>centre) <span class="ot">&lt;-</span> contr.sum</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation du modèle avec effet fixe par centre</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>mod.lmci <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">*</span>centre, <span class="at">data=</span>dtlbis)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># affichage dans un cat()</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La pente intra-centres estimée est de"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mod.lmci)<span class="sc">$</span>coefficients[<span class="st">"x"</span>,<span class="st">"Estimate"</span>],<span class="dv">2</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avec une erreur standard de"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mod.lmci)<span class="sc">$</span>coefficients[<span class="st">"x"</span>,<span class="st">"Std. Error"</span>],<span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>La pente intra-centres estimée est de 131.66 avec une erreur standard de 39.47 </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Modèle avec pente commune <span class="math inline">\(Y_{ij} = a + [a.\text{centre}_j] + b\, x_{ij} + \varepsilon_{ij}\)</span></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod.lmc <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>centre, <span class="at">data=</span>dtl)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La pente intra-centres estimée est de"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mod.lmc)<span class="sc">$</span>coefficients[<span class="st">"x"</span>,<span class="st">"Estimate"</span>],<span class="dv">2</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avec une erreur standard de"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(mod.lmc)<span class="sc">$</span>coefficients[<span class="st">"x"</span>,<span class="st">"Std. Error"</span>],<span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>La pente intra-centres estimée est de 118.26 avec une erreur standard de 31.51 </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Modèle mixte avec effet aléatoire de centre <span class="math inline">\(Y_{ij} = a + (a_{\text{centre}*j}) + b, x*{ij} + \varepsilon_{ij}\)</span></li>
</ol>
<p>Il faut utiliser la fonction <code>lmer()</code> de la bibliothèque <code>lme4</code> ou <code>nlme</code>.</p>
<p>Syntaxe : <code>(1|centre)</code> signifie qu’on modélise un intercept aléatoire par centre.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mod.lmer1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y<span class="sc">~</span>x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>centre), <span class="at">data=</span>dtl)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.lmer1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: y ~ x + (1 | centre)
   Data: dtl

REML criterion at convergence: 11949.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1811 -0.6001  0.0126  0.6147  2.7906 

Random effects:
 Groups   Name        Variance Std.Dev.
 centre   (Intercept) 11242    106.03  
 Residual              5723     75.65  
Number of obs: 1000, groups:  centre, 200

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  291.354      9.146 346.352  31.857  &lt; 2e-16 ***
x            122.391     31.081 840.929   3.938 8.91e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
  (Intr)
x -0.509</code></pre>
</div>
</div>
<p>La méthode ici utilisée est la <strong>vraisemblance restreinte (REML)</strong>, dont le principe est d’estimer les paramètres de variance en maximisant la vraisemblance des résidus (c’est à dire leur cohérence avec les données observées), ce qui est préférable pour estimer les paramètres de variance des effets aléatoires.</p>
<p>L’effet centre et le résidus sont donc caractérisés par des variances estimées (du fait qu’on les considère comme des variables aléatoires).</p>
<p>La variance de l’effet centre est donc estimée sensiblement plus importante que le bruit présent dans le modèle (résidus).</p>
<p>L’estimation de la pente vaut 122,39, légèrement différente des modèles précédents.</p>
<p>Pour interpréter la pente d’un modèle à effets mixtes :</p>
<ul>
<li><p>Si la variance intra-centre de <span class="math inline">\(X\)</span> est très faible, la pente fixe du modèle mixte s’interprète comme une pente inter-centre.</p></li>
<li><p>Si la variance inter-centre de <span class="math inline">\(X\)</span> est faible (donc faible effet centre), la pente fixe s’interprète comme une pente intra-centre.</p></li>
</ul>
<ol start="4" type="1">
<li>Modèle mixte avec pente aléatoire par centre <span class="math inline">\(Y_{ij} = a + (a_{\text{centre}*j}) + (b_{\text{centre}*j}) x_{ij} + \varepsilon_{ij}\)</span></li>
</ol>
</section>
<section id="conditions-de-validités-des-modèles-mixtes" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="conditions-de-validités-des-modèles-mixtes"><span class="header-section-number">5.3.5</span> Conditions de validités des modèles mixtes</h3>
<ul>
<li><p>La pente inter-centres est égale à la moyenne des pentes intra-centres (c’est à dire que les pentes des centres ne diffèrent pas trop entre elles) ;</p></li>
<li><p>L’indépendance des résidus, ce qui peut poser des problèmes lorsque la structurede corrélation intra-centre est complexe, notamment lorsqu’elle est susceptible d’être négative, car les modèles mixtes classiques ne permettent pas de modéliser des corrélations négatives entre les observations d’un même centre ;</p></li>
<li><p>Contribution des plus gros centres supérieure à celle des petits centres. Ca pose problème uniquement si la taille du centre est corrélée à la variable <span class="math inline">\(Y\)</span>.</p></li>
<li><p>Indépendance, normalité, homoscédasticité et nullité moyenne des effets aléatoires ; qu’il s’agisse des ordonnées à l’origine spécifiques à chacun des centres ou de leurs pentes ;</p></li>
</ul>
</section>
</section>
<section id="modèle-marginal-gee-generalized-estimating-equations" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="modèle-marginal-gee-generalized-estimating-equations"><span class="header-section-number">5.4</span> Modèle marginal = GEE (Generalized Estimating Equations)</h2>
<p><span class="math inline">\(Y\)</span> : score de dépression, <span class="math inline">\(X\)</span> durée de l’entretien, patients regroupés par centre et il existe une corrélation intra-centre.</p>
<p>Approche conditionnelle (modèles mixtes, etc.) : “Quel est l’effet de X dans un centre donné ?”</p>
<p>Approche marginale : “Quel est l’effet de X en moyenne dans la population, tous centres confondus ?”</p>
<p><span class="math inline">\(\rightarrow\)</span> on ne modélise pas les centres un par un ; on s’intéresse à la moyenne globale et on corrige seulement la corrélation.</p>
<section id="définition" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="définition"><span class="header-section-number">5.4.1</span> Définition</h3>
<p>Dans l’approche conditionnelle : on réalise une série de modèles au sein même de chaque centre (on regarde ce qui se passe “à l’intérieur” des centres).</p>
<p>Dans l’approche marginale : on écrit un modèle très simple : en gros, comme lm(y~x), mais on remplace l’estimateur classique par un autre estimateur, qui corrige pour la corrélation intra-centre.</p>
<p>Il faut faire l’hypothèse d’égalité des pentes inter-centres et intra-centre : la pente de la relation <span class="math inline">\(X\)</span> - <span class="math inline">\(Y\)</span> est la même entre les centres (si on compare des centres entre eux) et à l’intérieur des centres (si on regarde les patients d’un même centre).</p>
<p>Sous cette hypothèse, l’estimation GEE de la pente est plus efficace (variance plus faible) que l’estimation naïve de <code>lm(y ~ x)</code>, c’est à dire même moyenne mais moins de variance.</p>
</section>
<section id="principe-des-gee" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="principe-des-gee"><span class="header-section-number">5.4.2</span> Principe des GEE</h3>
<ol type="1">
<li><p>D’abord estimation d’à quel point les observations d’un même centre sont corrélées entre elles (corrélation intra-centre).</p></li>
<li><p>Ensuite, GEE utilise cette information pour ajuster la manière de calculer les coefficients du modèle linéaire</p></li>
</ol>
<p>Si la corrélation intra-centre est faible, GEE donne des résultats très proches de <code>lm(y ~ x)</code>.</p>
<p>Si la corrélation intra-centre est forte, GEE fournit une estimation plus précise de la pente, mais l’interprétation de cette pente devient plus complexe.</p>
<p><img src="images/paste-72.png" class="img-fluid" width="448"></p>
<p>Simulations de jeux de données multicentriques de taille modeste (4 observations par centre dans 5 centres).</p>
<p>Les panneaux A, B et C correspondent à des jeux légèrement différents.</p>
<p>Dans les encadrés sont données :</p>
<ul>
<li><p>N°1 : les pentes fixes d’un modèle à effets mixtes à intercept aléatoire <span class="math inline">\(y_{ij} = a + [a.centre_j] + b x_{ij} + \varepsilon_{ij}\)</span>;</p></li>
<li><p>N°2 : les pentes d’un modèle à effets mixtes à intercept et pente aléatoires (<span class="math inline">\(y_{ij} = a + [a.centre_j] + b x_{ij} + [b.centre_j] x_{ij} + \varepsilon_{ij}\)</span>).</p></li>
<li><p>Les pentes d’un modèle linéaire estimé par GEE sont également estimées.</p></li>
</ul>
<p>Le symbole en gras représente la moyenne de chaque centre (barycentre des points du centre).</p>
<p>Une modification minime des données conduit les modèles à effets mixtes à estimer tantôt la pente inter-centres (décroissante donc négative), et tantôt la pente intra-centre (positive)</p>
<p>##is# Exemple R</p>
<p>Il faut utiliser la library <code>gee</code>.</p>
<p>Dans la syntaxe, l’utilisation de <code>order</code> est indispensable pour que les observations soient regroupées par centre.</p>
<p>L’option <code>corstr="exchangeable"</code> indique que la corrélation intra-centre est supposée identique entre toutes les paires d’observations d’un même centre (structure de corrélation dite “échangeable”), c’est à dire que la corrélation entre les observations 1 et 2 d’un centre est la même que celle entre les observations 1 et 3, etc.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dtlgee <span class="ot">&lt;-</span> dtl[<span class="fu">order</span>(dtl<span class="sc">$</span>centre,dtl<span class="sc">$</span>temps),]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mod.gee <span class="ot">&lt;-</span> <span class="fu">gee</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                y<span class="sc">~</span>x, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dtlgee, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">id=</span>centre, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr=</span><span class="st">"exchangeable"</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>running glm to get initial regression estimate</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
   286.6649    153.6712 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.gee)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Exchangeable 

Call:
gee(formula = y ~ x, id = centre, data = dtlgee, corstr = "exchangeable")

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-391.96041  -86.83861    2.71576   83.68505  368.27139 


Coefficients:
            Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept) 291.3500   9.135526 31.891982    9.410923 30.958709
x           122.4175  31.121353  3.933554   34.743959  3.523419

Estimated Scale Parameter:  16929.16
Number of Iterations:  2

Working Correlation
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 1.0000000 0.6610401 0.6610401 0.6610401 0.6610401
[2,] 0.6610401 1.0000000 0.6610401 0.6610401 0.6610401
[3,] 0.6610401 0.6610401 1.0000000 0.6610401 0.6610401
[4,] 0.6610401 0.6610401 0.6610401 1.0000000 0.6610401
[5,] 0.6610401 0.6610401 0.6610401 0.6610401 1.0000000</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="modèle-linéaire-généralisé" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Modèle linéaire généralisé</h1>
<section id="principes-généraux" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="principes-généraux"><span class="header-section-number">6.1</span> Principes généraux</h2>
<p>Si <span class="math inline">\(Y\)</span> n’est plus une variable quantitative normalement distribuée, mais une variable binaire (ex: succès/échec), on peut utiliser un modèle linéaire généralisé (GLM) avec une fonction de lien logit (régression logistique).</p>
<p>NB : condition de validité de l’estimateur du maximum de vraisemblance de la régression logistique = au moins 5 à 10 évènements par variable explicative incluse dans le modèle.</p>
<p>On peut faire une “régression logistique conditionnelle” :</p>
<ul>
<li><p>vraisemblance partielle au sein de chaque centre puis agréger ces vraisemblances en une seule valeur</p>
<ul>
<li>permet d’obtenir des OR intra-centres, mais empêche l’étude de l’effet centre lui-même.</li>
</ul></li>
<li><p>“modèle linéaire généralisé à effets mixtes = GLMM” (Generalized Linear Mixed Model) :</p>
<ul>
<li>la variable (centre) est vue comme un effet aléatoire.</li>
</ul></li>
</ul>
<p>On peut aussi faire une approche “marginale” :</p>
<ul>
<li><p>Ignorer l’effet centre en premier lieu (modèle logistique simple), avec si possible un bootstrap par grappe ou un estimateur sandwich pour corriger l’erreur standard pour prendre en compte la corrélation intra-centre.</p></li>
<li><p>Utiliser un modèle GEE avec une fonction de lien logit pour obtenir des OR “marginales” corrigées de la corrélation intra-centre.</p></li>
</ul>
</section>
<section id="exemple-r-avec-données-simulées" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="exemple-r-avec-données-simulées"><span class="header-section-number">6.2</span> Exemple R avec données simulées</h2>
<p>On reprend le jeu de données simulées mais transforme <span class="math inline">\(Y\)</span> en variable binaire selon un seuil de 300.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dtl<span class="sc">$</span>y.b <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dtl<span class="sc">$</span>y<span class="sc">&gt;</span><span class="dv">300</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dtlbis<span class="sc">$</span>y.b <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dtlbis<span class="sc">$</span>y<span class="sc">&gt;</span><span class="dv">300</span>,<span class="dv">1</span>,<span class="dv">0</span>) </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>dtlgee<span class="sc">$</span>y.b <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dtlgee<span class="sc">$</span>y<span class="sc">&gt;</span><span class="dv">300</span>,<span class="dv">1</span>,<span class="dv">0</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol type="1">
<li>Modèle non ajusté : régression logistique simple sans prise en compte de l’effet centre</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>modglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(y.b<span class="sc">~</span>x,<span class="at">data=</span>dtl,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tableau gt summary avec modify footnote pour dire comment les OR ont été obtenus (en anglais)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>tbl_glm <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    modglm,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(x <span class="sc">~</span> <span class="st">"Duration of interview (X)"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">modify_footnote</span>(</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        estimate <span class="sc">~</span> <span class="st">"Odds Ratios (OR) calculated from logistic regression model without accounting for center effect."</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>tbl_glm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="lcbajswict" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lcbajswict table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lcbajswict thead, #lcbajswict tbody, #lcbajswict tfoot, #lcbajswict tr, #lcbajswict td, #lcbajswict th {
  border-style: none;
}

#lcbajswict p {
  margin: 0;
  padding: 0;
}

#lcbajswict .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lcbajswict .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lcbajswict .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lcbajswict .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lcbajswict .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcbajswict .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcbajswict .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcbajswict .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lcbajswict .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lcbajswict .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lcbajswict .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lcbajswict .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lcbajswict .gt_spanner_row {
  border-bottom-style: hidden;
}

#lcbajswict .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lcbajswict .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lcbajswict .gt_from_md > :first-child {
  margin-top: 0;
}

#lcbajswict .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lcbajswict .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lcbajswict .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lcbajswict .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lcbajswict .gt_row_group_first td {
  border-top-width: 2px;
}

#lcbajswict .gt_row_group_first th {
  border-top-width: 2px;
}

#lcbajswict .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcbajswict .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lcbajswict .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lcbajswict .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcbajswict .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcbajswict .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lcbajswict .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lcbajswict .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lcbajswict .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcbajswict .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcbajswict .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcbajswict .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcbajswict .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcbajswict .gt_left {
  text-align: left;
}

#lcbajswict .gt_center {
  text-align: center;
}

#lcbajswict .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lcbajswict .gt_font_normal {
  font-weight: normal;
}

#lcbajswict .gt_font_bold {
  font-weight: bold;
}

#lcbajswict .gt_font_italic {
  font-style: italic;
}

#lcbajswict .gt_super {
  font-size: 65%;
}

#lcbajswict .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lcbajswict .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lcbajswict .gt_indent_1 {
  text-indent: 5px;
}

#lcbajswict .gt_indent_2 {
  text-indent: 10px;
}

#lcbajswict .gt_indent_3 {
  text-indent: 15px;
}

#lcbajswict .gt_indent_4 {
  text-indent: 20px;
}

#lcbajswict .gt_indent_5 {
  text-indent: 25px;
}

#lcbajswict .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lcbajswict div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Duration of interview (X)</td>
<td class="gt_row gt_center" headers="estimate">4.33</td>
<td class="gt_row gt_center" headers="conf.low">1.03, 18.4</td>
<td class="gt_row gt_center" headers="p.value">0.047</td>
</tr>
</tbody><tfoot>
<tr class="gt_footnotes odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Odds Ratios (OR) calculated from logistic regression model without accounting for center effect.</td>
</tr>
<tr class="gt_sourcenotes even">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>OR calculé caractérise la relation entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> en ignorant l’effet centre et en supposant que toutes les observations sont indépendantes.</p>
<ol start="2" type="1">
<li>Estimation par bootstrap par grappe</li>
</ol>
<p>Pour corriger l’erreur standard résultant de la corrélation intra-centre, on peut utiliser un bootstrap par grappe ou un estimateur sandwich.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap par grappe</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>modboot <span class="ot">&lt;-</span> <span class="fu">clusbootglm</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                    y.b<span class="sc">~</span>x,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>dtl,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clusterid=</span>centre,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>modboot<span class="sc">$</span>boot.coefs</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
-0.07882868  1.47121016 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>modboot<span class="sc">$</span>boot.sds</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
  0.1518630   0.7952629 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(modboot<span class="sc">$</span>boot.coefs)[<span class="dv">2</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       x 
4.354502 </code></pre>
</div>
</div>
<p>L’OR estimé après bootstrap est légèrement différent, et l’erreur standard est plus grande, reflétant l’incertitude accrue due à la corrélation intra-centre.</p>
<p>Le rapport entre le coefficient non exponentié et l’erreur standard permet de tester la présence d’une corrélation :</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Le rapport coefficient/erreur standard est de"</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((modboot<span class="sc">$</span>boot.coefs[<span class="dv">2</span>]) <span class="sc">/</span> (modboot<span class="sc">$</span>boot.sds[<span class="dv">2</span>]), <span class="dv">2</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le rapport coefficient/erreur standard est de 1.85 </code></pre>
</div>
</div>
<p>Le rapport entre le coefficient (non exponentié) et son erreur standard correspond au z-score du test de Wald.</p>
<p>Il sert à tester l’hypothèse nulle H0 : le coefficient de X est nul (OR = 1), c’est-à-dire « pas d’association entre X et Y » après correction de la corrélation intra-centre.</p>
<p>Si ce z-score est inférieur en valeur absolue à 1,96, on ne met pas en évidence d’association significative au seuil de 5 %.</p>
<p>Ici, le coefficient vaut 1,87 donc &lt; 1,96 → pas de preuve d’une association significative entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> après correction de la corrélation intra-centre.</p>
<ol start="3" type="1">
<li>Modèle ajusté à effet fixe : régression logistique avec ajustement sur la variable catégorielle [centre]</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>modglmaj <span class="ot">&lt;-</span> <span class="fu">glm</span>(y.b<span class="sc">~</span>x<span class="sc">+</span>centre,<span class="at">data=</span>dtl,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modglmaj)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Estimate Std. Error    z value   Pr(&gt;|z|) 
2.19692245 1.24982624 1.75778230 0.07878456 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">summary</span>(modglmaj)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, <span class="st">"Estimate"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.997281</code></pre>
</div>
</div>
<p>Le problème est que le modèle compte 199 variables indicatrices (dummy) pour les centres, ce qui est lourd.</p>
<p>Il faudrait au mieux 2000 observations pour respecter la règle des 10 évènements par variable, or il y en a 535.</p>
<ol start="4" type="1">
<li>Modèle logistique conditionnel :</li>
</ol>
<p>La fonction <code>clogit()</code> permet de faire une régression logistique conditionnelle en utilisant la vraisemblance partielle.</p>
<p>Vraisemblance partielle = méthode d’estimation qui permet d’éliminer les paramètres de nuisance (ici, les intercepts spécifiques à chaque centre) en conditionnant sur le nombre d’événements observés dans chaque groupe.</p>
<p>Au lieu d’estimer la probabilité absolue de l’événement, on estime la probabilité qu’un individu ait l’événement <em>sachant</em> le nombre total d’événements observés dans son centre.</p>
<p>Cela permet d’estimer l’association intra-centre sans avoir à estimer les coefficients de chaque centre.</p>
<p>C’est mathématiquement équivalent à un modèle de Cox stratifié.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">clogit</span>(y.b<span class="sc">~</span>x<span class="sc">+</span><span class="fu">strata</span>(centre),dtl))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(rep(1, 1000L), y.b) ~ x + strata(centre), 
    data = dtl, method = "exact")

  n= 1000, number of events= 535 

   coef exp(coef) se(coef)     z Pr(&gt;|z|)
x 1.754     5.779    1.115 1.573    0.116

  exp(coef) exp(-coef) lower .95 upper .95
x     5.779      0.173    0.6494     51.43

Concordance= 0.551  (se = 0.037 )
Likelihood ratio test= 2.48  on 1 df,   p=0.1
Wald test            = 2.47  on 1 df,   p=0.1
Score (logrank) test = 2.49  on 1 df,   p=0.1</code></pre>
</div>
</div>
<p>Le coefficient obtenu correspond au Log-Odds Ratio intra-centre.</p>
<ol start="5" type="1">
<li>Modèle mixte à pente commune</li>
</ol>
<p>Ici, la pente commune correspond à une pente commune au sein des différents centres.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>moglmer1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y.b<span class="sc">~</span>x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>centre),<span class="at">data=</span>dtl,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(moglmer1)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Estimate Std. Error    z value   Pr(&gt;|z|) 
1.92515054 1.01661177 1.89369294 0.05826578 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">summary</span>(moglmer1)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, <span class="st">"Estimate"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.856181</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Modèle mixte autorisant des pentes propres à chaque centre</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>modglmer2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y.b<span class="sc">~</span>x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">|</span>centre),<span class="at">data=</span>dtl,<span class="at">family=</span><span class="st">"binomial"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modglmer2)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Estimate Std. Error    z value   Pr(&gt;|z|) 
 2.3676541  1.0784455  2.1954323  0.0281326 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">summary</span>(modglmer2)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, <span class="st">"Estimate"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.67233</code></pre>
</div>
</div>
<p><code>boundary (singular) fit: see help('isSingular')</code> nous alerte sur un possible problème numérique : cela signifie que le modèle a du mal à estimer certains paramètres en raison d’une matrice de variance-covariance singulière, souvent causée par un manque de variabilité dans les données ou une sur-paramétrisation du modèle.</p>
<ol start="7" type="1">
<li>Modèle marginal GEE avec fonction de lien logit</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>modgee <span class="ot">&lt;-</span> <span class="fu">gee</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                y.b<span class="sc">~</span>x, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>dtlgee, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">id=</span>centre, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr=</span><span class="st">"exchangeable"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"binomial"</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>running glm to get initial regression estimate</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
-0.07879536  1.46485165 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modgee)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Estimate  Naive S.E.     Naive z Robust S.E.    Robust z 
  1.1122609   0.6119977   1.8174265   0.6426709   1.7306851 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">summary</span>(modgee)<span class="sc">$</span>coefficients[<span class="st">"x"</span>, <span class="st">"Estimate"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.041227</code></pre>
</div>
</div>
<hr>
<p>Au final, on a 7 OR différents avec des IC et des pvalue différentes :</p>
<div class="cell">
<div class="cell-output-display">
<div id="vibettmmgl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vibettmmgl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vibettmmgl thead, #vibettmmgl tbody, #vibettmmgl tfoot, #vibettmmgl tr, #vibettmmgl td, #vibettmmgl th {
  border-style: none;
}

#vibettmmgl p {
  margin: 0;
  padding: 0;
}

#vibettmmgl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vibettmmgl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vibettmmgl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vibettmmgl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vibettmmgl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vibettmmgl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vibettmmgl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vibettmmgl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vibettmmgl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vibettmmgl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vibettmmgl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vibettmmgl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vibettmmgl .gt_spanner_row {
  border-bottom-style: hidden;
}

#vibettmmgl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vibettmmgl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vibettmmgl .gt_from_md > :first-child {
  margin-top: 0;
}

#vibettmmgl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vibettmmgl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vibettmmgl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vibettmmgl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vibettmmgl .gt_row_group_first td {
  border-top-width: 2px;
}

#vibettmmgl .gt_row_group_first th {
  border-top-width: 2px;
}

#vibettmmgl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vibettmmgl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vibettmmgl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vibettmmgl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vibettmmgl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vibettmmgl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vibettmmgl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vibettmmgl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vibettmmgl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vibettmmgl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vibettmmgl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vibettmmgl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vibettmmgl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vibettmmgl .gt_left {
  text-align: left;
}

#vibettmmgl .gt_center {
  text-align: center;
}

#vibettmmgl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vibettmmgl .gt_font_normal {
  font-weight: normal;
}

#vibettmmgl .gt_font_bold {
  font-weight: bold;
}

#vibettmmgl .gt_font_italic {
  font-style: italic;
}

#vibettmmgl .gt_super {
  font-size: 65%;
}

#vibettmmgl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vibettmmgl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vibettmmgl .gt_indent_1 {
  text-indent: 5px;
}

#vibettmmgl .gt_indent_2 {
  text-indent: 10px;
}

#vibettmmgl .gt_indent_3 {
  text-indent: 15px;
}

#vibettmmgl .gt_indent_4 {
  text-indent: 20px;
}

#vibettmmgl .gt_indent_5 {
  text-indent: 25px;
}

#vibettmmgl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vibettmmgl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">OR selon la methode d'estimation</td>
</tr>
<tr class="gt_col_headings even">
<th id="Method" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Estimation Method</th>
<th id="OR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Odds Ratio (OR)</th>
<th id="IC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Standard Error</th>
<th id="pvalue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p-value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Method">Non ajuste (GLM)</td>
<td class="gt_row gt_right" headers="OR">4.33</td>
<td class="gt_row gt_right" headers="IC">0.74</td>
<td class="gt_row gt_right" headers="pvalue">0.0466</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Method">Bootstrap ajuste (clusbootglm)</td>
<td class="gt_row gt_right" headers="OR">4.35</td>
<td class="gt_row gt_right" headers="IC">0.80</td>
<td class="gt_row gt_right" headers="pvalue">0.0643</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Method">Effet fixe ajuste (GLM + centre)</td>
<td class="gt_row gt_right" headers="OR">9.00</td>
<td class="gt_row gt_right" headers="IC">1.25</td>
<td class="gt_row gt_right" headers="pvalue">0.0788</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Method">Conditionnel (clogit)</td>
<td class="gt_row gt_right" headers="OR">5.78</td>
<td class="gt_row gt_right" headers="IC">1.12</td>
<td class="gt_row gt_right" headers="pvalue">0.1157</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Method">Pente commune mixte (glmer)</td>
<td class="gt_row gt_right" headers="OR">6.86</td>
<td class="gt_row gt_right" headers="IC">1.02</td>
<td class="gt_row gt_right" headers="pvalue">0.0583</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Method">Pente aleatoire mixte (glmer)</td>
<td class="gt_row gt_right" headers="OR">10.67</td>
<td class="gt_row gt_right" headers="IC">1.08</td>
<td class="gt_row gt_right" headers="pvalue">0.0281</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Method">Marginal (GEE)</td>
<td class="gt_row gt_right" headers="OR">3.04</td>
<td class="gt_row gt_right" headers="IC">0.64</td>
<td class="gt_row gt_right" headers="pvalue">0.0835</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Quel modèle choisir en pratique ?</p>
<p>Le choix du modèle dépend avant tout de la question scientifique et de la manière dont l’échantillon de centres est considéré.</p>
<ol type="1">
<li>Objectif : mesurer une association globale dans la population (OR marginal)</li>
</ol>
<p>Si l’échantillon a vocation à représenter une population cible, et que la question est :</p>
<p>« Quelle est la force de l’association entre Y.b et X globalement, dans cette population, en tenant compte du fait que les sujets sont regroupés par centre ? »,</p>
<p>alors l’approche logistique simple avec correction de l’erreur standard par bootstrap de grappes est souvent la plus naturelle.</p>
<p>Concrètement, on ajuste un modèle logistique standard glm(y.b ~ x, family = binomial) puis on corrige l’incertitude (erreur standard, IC, p-value) par un bootstrap par centre.</p>
<ul>
<li><p>La pente estimée (et l’OR correspondant) reste très transparente à interpréter : c’est un OR marginal moyen, sur l’ensemble des sujets, exposés vs non exposés.</p></li>
<li><p>Le bootstrap corrige l’optimisme de l’erreur standard dû à la corrélation intra-centre, sans introduire de structure de modèle supplémentaire.</p></li>
<li><p>L’approche reste techniquement simple et robuste, au prix d’un peu de calcul.</p></li>
</ul>
<p>Dans la même philosophie, un modèle GEE logistique (avec gee() et family = binomial) fournit aussi un OR marginal, mais cette fois-ci via une construction plus sophistiquée, qui impose de choisir une structure de corrélation (ex. « exchangeable »). Dans les situations standard, la logistique simple + bootstrap par centre suffit souvent, et a l’avantage d’être plus transparente.</p>
<ol start="2" type="1">
<li>Objectif : contrôler l’effet centre comme facteur de confusion (OR conditionnel)</li>
</ol>
<p>Si la question est :</p>
<p>« Quelle est la relation entre Y.b et X à l’intérieur des centres, en traitant le centre comme un facteur de confusion ou de nuisance ? »,</p>
<p>alors il s’agit d’estimer un OR conditionnel au centre.</p>
<p>Plusieurs modèles répondent à cette logique :</p>
<ul>
<li><p>la régression logistique conditionnelle (clogit(y.b ~ x + strata(centre))) ;</p></li>
<li><p>le modèle mixte à pente commune (glmer(y.b ~ x + (1|centre))) ;</p></li>
<li><p>le modèle mixte avec pentes aléatoires par centre (glmer(y.b ~ x + (1 + x|centre))).</p></li>
</ul>
<p>Dans tous les cas, l’OR est conditionnel au centre : il répond à une question du type « à centre donné, quelle est l’association entre X et Y.b ? ».</p>
<p>Cette interprétation est plus délicate, car l’OR dépend d’une information (le centre) qui est rarement observable ou utilisable en pratique au moment de la prise de décision.</p>
<p>Ces modèles sont théoriquement valides, mais :</p>
<ul>
<li><p>reposent sur des hypothèses fortes (homogénéité des effets, distribution normale des effets aléatoires, structure de corrélation, etc.) ;</p></li>
<li><p>peuvent conduire à des problèmes numériques (convergence, singularité) dès que la structure devient un peu complexe (pentes aléatoires, peu d’événements par centre, centres très hétérogènes).</p></li>
</ul>
<p>Il s’agit de modèles puissants, mais qui nécessitent un usage prudent et une expertise spécifique, surtout pour les modèles mixtes avec pentes aléatoires.</p>
<ol start="3" type="1">
<li>Modèle à effets fixes de centre : cas très limité</li>
</ol>
<p>La régression logistique avec effet fixe de centre (glm(y.b ~ x + centre, family = binomial)) introduit une variable indicatrice pour chaque centre.</p>
<p>En pratique, ce modèle est à éviter dès que le nombre de centres est un peu important :</p>
<ul>
<li><p>il consomme énormément de degrés de liberté (une vingtaine de centres = une vingtaine de paramètres supplémentaires) ;</p></li>
<li><p>il viole rapidement la règle « 10 événements par variable » ;</p></li>
<li><p>il n’apporte pas d’information synthétique sur la variabilité entre centres.</p></li>
</ul>
<p>Il n’est raisonnable que si le nombre de centres est très faible (par exemple &lt; 5) et que chaque centre dispose de beaucoup de sujets.</p>
<ol start="4" type="1">
<li>Marge vs conditionnel : conséquences sur l’OR</li>
</ol>
<p>Les modèles GEE donnent un OR marginal, c’est-à-dire une comparaison des cotes de prévalence de la maladie chez tous les exposés vs tous les non exposés, après « gommage » de l’effet centre.</p>
<p>À l’inverse, la logistique conditionnelle et les modèles mixtes (pente commune ou pentes aléatoires) produisent des OR conditionnels au centre. En présence d’une forte variabilité du risque de base entre centres, ces OR conditionnels peuvent être beaucoup plus grands que l’OR marginal issu d’un GEE ou d’un modèle simple corrigé par bootstrap.</p>
<p>En résumé :</p>
<ul>
<li><p>OR marginal (GLM + bootstrap, GEE) : mesure l’effet « moyen » dans la population globale ;</p></li>
<li><p>OR conditionnel (clogit, GLMM) : mesure l’effet « à centre donné », avec une interprétation plus abstraite.</p></li>
</ul>
<ol start="5" type="1">
<li>Synthèse pratique</li>
</ol>
<ul>
<li><p>Si l’objectif est une mesure simple, robuste et interprétable de la force d’association globale entre X et Y.b dans une population représentée par l’échantillon, la solution la plus raisonnable est :</p>
<ul>
<li><p>modèle logistique simple glm(y.b ~ x, family = binomial)</p></li>
<li><p>avec correction de l’erreur standard par bootstrap de grappes sur le centre.</p></li>
</ul></li>
<li><p>Si l’objectif est de contrôler strictement l’effet du centre comme facteur de confusion et d’obtenir un OR au sein des centres, la logistique conditionnelle ou un modèle mixte à pente commune sont des candidats possibles, mais leur usage doit rester réservé aux situations où la question scientifique l’exige vraiment et avec un contrôle soigneux des hypothèses et de la convergence.</p></li>
<li><p>Les modèles mixtes avec pentes aléatoires n’apportent un gain réel que si l’on souhaite modéliser explicitement l’hétérogénéité de l’effet de X d’un centre à l’autre et si l’échantillon contient suffisamment d’information pour les estimer correctement.</p></li>
<li><p>Les GEE binaires se justifient surtout lorsque l’on souhaite un OR marginal avec une estimation plus « théorique » de la variance, en acceptant une certaine complexité de mise en œuvre et d’interprétation.</p></li>
</ul>
<p>En pratique, sauf question très spécifique sur la structure centre par centre, l’association globale X–Y.b dans une étude multicentrique sera souvent décrite de façon honnête et pragmatique par un modèle logistique simple combiné à un bootstrap par grappe sur le centre, en explicitant clairement que l’OR rapporté est un OR marginal ajusté pour la corrélation intra-centre.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1_resume_statistique.html" class="pagination-link" aria-label="Résumé statistique">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Résumé statistique</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>