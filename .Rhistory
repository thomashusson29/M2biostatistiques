data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
fit <- survfit(Surv(survival, eventdeath) ~ grade, data = ks)
p <- ggsurvplot(
fit,
data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
p
p <- ggsurvplot(
fit,
data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
p <- ggsurvplot(
fit,
data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
print(p)
p <- ggsurvplot(
fit,
data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
print(p)
p <- ggsurvplot(
fit,
data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
print(p)
p <- ggsurvplot(
fit,
data = ks,
palette = viridis(3),
conf.int = TRUE,
xlab = "Temps en années",
ylab = "Probabilité de survie"
)
print(p)
library(survival)
library(broom)
library(ggplot2)
library(viridis)
# 1. Modele de survie
fit <- survfit(Surv(survival, eventdeath) ~ grade, data = ks)
# 2. Conversion en data.frame utilisable par ggplot
df <- tidy(fit)
# 3. Plot ggplot2
ggplot(df, aes(x = time, y = estimate, color = strata)) +
geom_step(linewidth = 1) +
scale_color_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
labs(
x = "Temps en années",
y = "Probabilité de survie",
color = "Grade"
) +
theme_minimal(base_size = 14)
library(survival)
library(broom)
library(ggplot2)
library(viridis)
# 1. Modele de survie
fit <- survfit(Surv(survival, eventdeath) ~ grade, data = ks)
# 2. Conversion en data.frame utilisable par ggplot
df <- tidy(fit)
# 3. Plot ggplot2
ggplot(df, aes(x = time, y = estimate, color = strata)) +
geom_step(linewidth = 1) +
scale_color_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
labs(
x = "Temps en années",
y = "Probabilité de survie",
color = "Grade"
) +
theme_minimal(base_size = 14)
#afficher intervalle de confiance
ggplot(df, aes(x = time, y = estimate, color = strata)) +
geom_step(linewidth = 1) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = strata), alpha = 0.2, color = NA) +
scale_color_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
scale_fill_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
labs(
x = "Temps en années",
y = "Probabilité de survie",
color = "Grade",
fill = "Grade"
) +
theme_minimal(base_size = 14)
library(survival)
library(broom)
library(ggplot2)
library(viridis)
# 1. Modele de survie
fit <- survfit(Surv(survival, eventdeath) ~ grade, data = ks)
# 2. Conversion en data.frame utilisable par ggplot
df <- tidy(fit)
# 3. Plot ggplot2 avec intervalle de confiance
ggplot(df, aes(x = time, y = estimate, color = strata)) +
geom_step(linewidth = 1) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = strata), alpha = 0.2, color = NA) +
scale_color_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
scale_fill_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
labs(
x = "Temps en années",
y = "Probabilité de survie",
color = "Grade",
fill = "Grade"
) +
theme_minimal(base_size = 14)
library(survival)
library(broom)
library(ggplot2)
library(viridis)
# 1. Modele de survie
fit <- survfit(Surv(survival, eventdeath) ~ grade, data = ks)
# 2. Conversion en data.frame utilisable par ggplot
df <- tidy(fit)
# 3. Plot ggplot2 avec intervalle de confiance
ggplot(df, aes(x = time, y = estimate, color = strata)) +
geom_step(linewidth = 1) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = strata), alpha = 0.2, color = NA) +
scale_color_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
scale_fill_viridis(discrete = TRUE, option = "D", begin = 0.1, end = 0.9) +
labs(
x = "Temps en années",
y = "Probabilité de survie",
color = "Grade",
fill = "Grade"
) +
theme_minimal(base_size = 14)
plot(survfit(Surv(survival, eventdeath)~grade,data=ks),xlab="Temps en années",ylab="Probabilité de survie",col=viridis(3),lwd=2)
legend("topright",legend=paste("Grade ",1:3),col=viridis(3),lwd=2)
boxplot(age~recherche.nouv, data=smp, ylab="Age", xlab="Recherche de nouveauté", cex.axis=1.2, cex.lab=1.2, col="white", main="")
boxplot(age~recherche.nouv, data=smp, ylab="Age", xlab="Recherche de nouveaut?", cex.axis=1.2, cex.lab=1.2, col="white", main="")
xjit1 <- jitter(rep(1, table(smp$recherche.nouv)[1]),amount=0.1)
points(xjit1, na.omit(smp$age[smp$recherche.nouv==1]), pch=20, col=rgb(0,0,0,.3))
xjit2 <- jitter(rep(2, table(smp$recherche.nouv)[2]),amount=0.1)
points(xjit2, na.omit(smp$age[smp$recherche.nouv==2]), pch=20, col=rgb(0,0,0,.3))
xjit3 <- jitter(rep(3, table(smp$recherche.nouv)[3]),amount=0.1)
points(xjit3, na.omit(smp$age[smp$recherche.nouv==3]), pch=20, col=rgb(0,0,0,.3))
#boxplot classique
boxplot(age~recherche.nouv, data=smp, ylab="Age", xlab="Recherche de nouveaut?", cex.axis=1.2, cex.lab=1.2, col="white", main="")
#ajout des points individuels avec jitter
xjit1 <- jitter(rep(1, table(smp$recherche.nouv)[1]),amount=0.1)
points(xjit1, na.omit(smp$age[smp$recherche.nouv==1]), pch=20, col=rgb(0,0,0,.3))
xjit2 <- jitter(rep(2, table(smp$recherche.nouv)[2]),amount=0.1)
points(xjit2, na.omit(smp$age[smp$recherche.nouv==2]), pch=20, col=rgb(0,0,0,.3))
xjit3 <- jitter(rep(3, table(smp$recherche.nouv)[3]),amount=0.1)
points(xjit3, na.omit(smp$age[smp$recherche.nouv==3]), pch=20, col=rgb(0,0,0,.3))
p <- ggplot(na.omit(smp[,c("recherche.nouv","age")]), aes(factor(recherche.nouv), age))
p <- p + geom_violin()
p <- p + geom_boxplot(width = .2, outlier.size = 2)
p <- p + theme_classic() + labs(y = "Age", x = "Recherche de nouveaut?")
p
p <- ggplot(na.omit(smp[,c("recherche.nouv","age")]), aes(factor(recherche.nouv), age))
p <- p + geom_violin(fill = "cornflowerblue")
p <- p + geom_boxplot(width = .2, outlier.size = 2, fill = "orange", outlier.color = "orange")
p <- p + labs(y = "Age", x = "Recherche de nouveaut?")
p
par(mfrow=c(1,3)) #sert à afficher 3 graphiques sur la même ligne
barplot(table(smp$recherche.nouv,useNA="ifany"), main="Recherche de la nouveaut?", ylab="n", ylim=c(0,350), space=0.6, names.arg=c("1","2","3","NA"), cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
barplot(table(smp$evit.danger,useNA="ifany"), main="Evitement de danger", ylab="n", ylim=c(0,350), space=0.6, names.arg=c("1","2","3","NA"), cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
barplot(table(smp$dep.recompense,useNA="ifany"), main="D?pendance ? la r?compense", ylim=c(0,350), ylab="n", names.arg=c("1","2","3","NA"), space=0.6, cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
par(mfrow=c(1,3)) #sert à afficher 3 graphiques sur la même ligne
barplot(table(smp$recherche.nouv,useNA="ifany"), main="Recherche de la nouveauté", ylab="n", ylim=c(0,350), space=0.6, names.arg=c("1","2","3","NA"), cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
barplot(table(smp$evit.danger,useNA="ifany"), main="Evitement de danger", ylab="n", ylim=c(0,350), space=0.6, names.arg=c("1","2","3","NA"), cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
barplot(table(smp$dep.recompense,useNA="ifany"), main="Dépendance à la récompense", ylim=c(0,350), ylab="n", names.arg=c("1","2","3","NA"), space=0.6, cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
par(mfrow=c(1,3)) #sert à afficher 3 graphiques sur la même ligne
barplot(table(smp$recherche.nouv,useNA="ifany"), main="Recherche de la nouveauté", ylab="n", ylim=c(0,350), space=0.6, names.arg=c("1","2","3","NA"), cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
barplot(table(smp$evit.danger,useNA="ifany"), main="Évitement de danger", ylab="n", ylim=c(0,350), space=0.6, names.arg=c("1","2","3","NA"), cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
barplot(table(smp$dep.recompense,useNA="ifany"), main="Dépendance à la récompense", ylim=c(0,350), ylab="n", names.arg=c("1","2","3","NA"), space=0.6, cex.axis=1.2, cex.names=1.2, col=c("white","white","white","grey"))
dt <- data.frame(table(smp$profession, useNA="ifany"))
dt$Var1 <- as.character(dt$Var1)
dt.tri <- dt[order(dt$Freq[1:(nrow(dt)-1)]),]
dt.tri[9,2] <- sum(is.na(smp$profession))
dt.tri[9,1] <- "NA"
par(mar=c(9,4,4,4))
barplot(dt.tri$Freq, las=2, names.arg=dt.tri$Var1, col=c(rep("white",8),"grey"))
par(mar=c(4,9,4,4))
barplot(dt.tri$Freq, las=1, names.arg=dt.tri$Var1, col=c(rep("white",8),"grey"),horiz=TRUE)
vir_9 <- viridis(n = 9)
dt$Var1[9] <- "NA"
pie(dt$Freq,col = vir_9,labels=dt$Var1,cex=1.4)
CairoWin()
vir_9 <- viridis(n = 9)
dt$Var1[9] <- "NA"
pie(dt$Freq,col = vir_9,labels=dt$Var1,cex=1.4)
pie(dt$Freq,col = gray(seq(0.1,0.85,length=9)),labels=dt$Var1,cex=1.4)
vir_9 <- viridis(n = 9)
dt$Var1[9] <- "NA"
pie(dt$Freq,col = vir_9,labels=dt$Var1,cex=1.4)
vir_9 <- viridis(n = 9)
dt$Var1[9] <- "NA"
pie(dt$Freq,col = vir_9,labels=dt$Var1,cex=1.4)
pie(dt$Freq,col = gray(seq(0.1,0.85,length=9)),labels=dt$Var1,cex=1.4)
vir_9 <- viridis(n = 9)
dt$Var1[9] <- "NA"
pie(dt$Freq,col = vir_9,labels=dt$Var1,cex=1.4)
treemap(dt, index="Var1", vSize="Freq", type="index", title="")
treemap(dt, index="Var1", vSize="Freq", type="manual", palette=rep("#FFFFFF",9), title="")
treemap(dt, index="Var1", vSize="Freq", type="index", title="")
plot(smp$age,smp$nb.enfants, xlab="Age", ylab="Nombre d'enfants", main="")
xy <- xyTable(smp$age,smp$nb.enfants)
coeff.reduc <- 0.5
CairoWin()
plot(smp$age,smp$nb.enfants, xlab="Age", ylab="Nombre d'enfants", main="")
xy <- xyTable(smp$age,smp$nb.enfants)
coeff.reduc <- 0.5
plot(xy$x , xy$y , cex=xy$number*coeff.reduc , pch=16 , col=rgb(0.15,0.15,0.15,0.3) , ylim=c(-2,14), cex.axis=1.2, cex.lab=1.2, xlab= "Age" , ylab="Nombre d'enfants")
plot(jitter(smp$age),jitter(smp$nb.enfants), xlab="Age (vibr?)", ylab="Nombre d'enfants (vibr?)", main="")
abline(lm(nb.enfants ~ age, data=smp), lwd=2, lty=2)
nona <- na.omit(smp[,c("nb.enfants","age")])
lines(lowess(nona$age,nona$nb.enfants), lwd=2, cex.axis=1.2, cex.lab=1.2)
plot(smp$age,smp$nb.enfants, xlab="Age", ylab="Nombre d'enfants", main="")
xy <- xyTable(smp$age,smp$nb.enfants)
coeff.reduc <- 0.5
plot(xy$x , xy$y , cex=xy$number*coeff.reduc , pch=16 , col=rgb(0.15,0.15,0.15,0.3) , ylim=c(-2,14), cex.axis=1.2, cex.lab=1.2, xlab= "Age" , ylab="Nombre d'enfants")
xy <- xyTable(smp$age,smp$nb.enfants)
coeff.reduc <- 0.5
plot(xy$x , xy$y , cex=xy$number*coeff.reduc , pch=16 , col=rgb(0.15,0.15,0.15,0.3) , ylim=c(-2,14), cex.axis=1.2, cex.lab=1.2, xlab= "Age" , ylab="Nombre d'enfants")
plot(jitter(smp$age),jitter(smp$nb.enfants), xlab="Age (vibr?)", ylab="Nombre d'enfants (vibr?)", main="")
abline(lm(nb.enfants ~ age, data=smp), lwd=2, lty=2)
nona <- na.omit(smp[,c("nb.enfants","age")])
lines(lowess(nona$age,nona$nb.enfants), lwd=2, cex.axis=1.2, cex.lab=1.2)
library(treemap)
tbl <- table(smp$profession,smp$depression)
groupe <- c(rep("D?prim?s",8),rep("Non d?prim?s",8))
sousgroupe <- rep(rownames(tbl),2)
valeurs <- c(tbl[,2],tbl[,1])
dt <- data.frame(groupe,sousgroupe,valeurs)
treemap(dt, index=c("groupe","sousgroupe"), vSize="valeurs",type="index")
library(treemap)
tbl <- table(smp$profession,smp$depression)
groupe <- c(rep("Déprimés",8),rep("Non déprimés",8))
sousgroupe <- rep(rownames(tbl),2)
valeurs <- c(tbl[,2],tbl[,1])
dt <- data.frame(groupe,sousgroupe,valeurs)
treemap(dt, index=c("groupe","sousgroupe"), vSize="valeurs",type="index")
d1 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=mean)
names(d1) <- c("date","age","mean")
d2 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=sd)
d3 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=length)
d1$sem <- d2$x/sqrt(d3$x)
pd <- position_dodge(0.1)
p <- ggplot(d1, aes(x=date, y=mean, group = age, colour= age))
p <- p + geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), colour="black", width=.2, position=pd)
p <- p + geom_line(position=pd)
p <- p + geom_point(position=pd, size=3, shape=21, fill="white")
p <- p + theme_classic() + labs(y = "Score de d?pression (m +/- sem)", x = "Date de visite")
p <- p + theme(axis.title.x = element_text(size=14),axis.title.y = element_text(size=14))
p <- p + theme(axis.text.x = element_text(size=14),axis.text.y = element_text(size=14))
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
d1 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=mean)
names(d1) <- c("date","age","mean")
d2 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=sd)
d3 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=length)
d1$sem <- d2$x/sqrt(d3$x)
pd <- position_dodge(0.1)
p <- ggplot(d1, aes(x=date, y=mean, group = age, colour= age))
p <- p + geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), colour="black", width=.2, position=pd)
p <- p + geom_line(position=pd)
p <- p + geom_point(position=pd, size=3, shape=21, fill="white")
p <- p + theme_classic() + labs(y = "Score de dépression (m +/- sem)", x = "Date de visite")
p <- p + theme(axis.title.x = element_text(size=14),axis.title.y = element_text(size=14))
p <- p + theme(axis.text.x = element_text(size=14),axis.text.y = element_text(size=14))
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
#p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
#p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
#p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Dur?e de suivie en jours")
#p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
#p
CairoWin()
#p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
#p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
#p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Dur?e de suivie en jours")
#p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
#p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = age>30), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = age>30), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
rm(list=ls())
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = age>30), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de dépression", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
View(smp)
list=ls()
acp <- smp[,c("schizophrenie","depression","tbl.bipol","anxiete.gen","stress.trauma",
"att.panique","agoraphobie","toc","phobie.soc","alcoolisme","abus.subst")]
#mdspca(acp)
sphpca(acp)
sphpca(smp[,c(75:79,81:85,87:91)],h=-40)
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualit?","ralenti","agit?","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
CairoWin()
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualit?","ralenti","agit?","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, legend=FALSE,
layout="spring", edge.color=rgb(0,0.5,0.5),edge.width=0.5)
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualit?","ralenti","agit?","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualité","ralenti","agité","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
acp <- smp[,c("schizophrenie","depression","tbl.bipol","anxiete.gen","stress.trauma",
"att.panique","agoraphobie","toc","phobie.soc","alcoolisme","abus.subst")]
mdspca(acp)
sphpca(acp)
sphpca(smp[,c(75:79,81:85,87:91)],h=-40)
acp <- smp[,c("schizophrenie","depression","tbl.bipol","anxiete.gen","stress.trauma",
"att.panique","agoraphobie","toc","phobie.soc","alcoolisme","abus.subst")]
mdspca(acp)
sphpca(acp)
somatisation <- c(1, 4, 12, 27, 42, 48, 49, 52, 53, 56, 58, 40)
obsession <- c(9, 10, 28, 38, 3, 45, 46, 51, 55, 65)
sensitivite <- c(6, 21, 34, 36, 37, 41, 61, 69, 73)
depression <- c(5, 14, 15, 20, 22, 26, 29, 30, 31, 32, 54, 71, 79)
anxiete <- c(2, 17, 23, 33, 39, 57, 72, 78, 80, 86)
hostilite <- c(11, 24, 63, 67, 74, 81)
phobie <- c(13, 25, 47, 70, 75, 82, 50)
paranoia <- c(8, 18, 43, 68, 76, 83)
psychose <- c(7, 16, 35, 62, 77, 84, 85, 87, 90, 88)
divers <- c(19, 44, 59, 60, 64, 66, 89)
scl.dim <- scl[,5+c(somatisation,obsession,sensitivite,depression,anxiete,hostilite,phobie,paranoia,psychose,divers)]
library(viridisLite)
dsph <- function(x) {as.dist(0.5*(1-x)^2)}
heatmap(cor(na.omit(scl.dim)), col=viridis(255), scale="none", distfun=dsph, Rowv=NA, Colv=NA,
cexRow=0.7, cexCol=0.7, labRow=substring(names(scl.dim), 2, 20), labCol=substring(names(scl.dim), 2, 20))
legend(x="right", legend=(-5:5)/5, fill=viridis(11))
library(reshape2)
scl.w <- dcast(scl[,c("NUMERO","VISIT","depression")], NUMERO~VISIT, value.var="depression")
scl.w <- scl.w[,-c(1,10)]
int <- scl.w
int[is.na(int)] <- 0
couleurs <- viridis(255)
couleurs[1] <- "#000000FF"
CairoWin()
library(reshape2)
scl.w <- dcast(scl[,c("NUMERO","VISIT","depression")], NUMERO~VISIT, value.var="depression")
scl.w <- scl.w[,-c(1,10)]
int <- scl.w
int[is.na(int)] <- 0
couleurs <- viridis(255)
couleurs[1] <- "#000000FF"
heatmap(as.matrix(int), col=couleurs, scale="none", Rowv=NULL, Colv=NA)
install.packages("reshape2")
install.packages("reshape2")
library(ape)
library(igraph)
wc <-apply(tdm3,2,sum,na.rm=TRUE)
library(ape)
library(igraph)
wc <-apply(tdm2,2,sum,na.rm=TRUE)
phylo_tree <- as.phylo(clus.ph)
tdm2
library(ape)
library(igraph)
wc <-apply(tdm2,2,sum,na.rm=TRUE)
phylo_tree <- as.phylo(clus.ph)
View(tdm2)
ls()
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
1 + 1
