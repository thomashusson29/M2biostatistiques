coeff.reduc <- 0.5
plot(xy$x , xy$y , cex=xy$number*coeff.reduc , pch=16 , col=rgb(0.15,0.15,0.15,0.3) , ylim=c(-2,14), cex.axis=1.2, cex.lab=1.2, xlab= "Age" , ylab="Nombre d'enfants")
xy <- xyTable(smp$age,smp$nb.enfants)
coeff.reduc <- 0.5
plot(xy$x , xy$y , cex=xy$number*coeff.reduc , pch=16 , col=rgb(0.15,0.15,0.15,0.3) , ylim=c(-2,14), cex.axis=1.2, cex.lab=1.2, xlab= "Age" , ylab="Nombre d'enfants")
plot(jitter(smp$age),jitter(smp$nb.enfants), xlab="Age (vibr?)", ylab="Nombre d'enfants (vibr?)", main="")
abline(lm(nb.enfants ~ age, data=smp), lwd=2, lty=2)
nona <- na.omit(smp[,c("nb.enfants","age")])
lines(lowess(nona$age,nona$nb.enfants), lwd=2, cex.axis=1.2, cex.lab=1.2)
library(treemap)
tbl <- table(smp$profession,smp$depression)
groupe <- c(rep("D?prim?s",8),rep("Non d?prim?s",8))
sousgroupe <- rep(rownames(tbl),2)
valeurs <- c(tbl[,2],tbl[,1])
dt <- data.frame(groupe,sousgroupe,valeurs)
treemap(dt, index=c("groupe","sousgroupe"), vSize="valeurs",type="index")
library(treemap)
tbl <- table(smp$profession,smp$depression)
groupe <- c(rep("Déprimés",8),rep("Non déprimés",8))
sousgroupe <- rep(rownames(tbl),2)
valeurs <- c(tbl[,2],tbl[,1])
dt <- data.frame(groupe,sousgroupe,valeurs)
treemap(dt, index=c("groupe","sousgroupe"), vSize="valeurs",type="index")
d1 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=mean)
names(d1) <- c("date","age","mean")
d2 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=sd)
d3 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=length)
d1$sem <- d2$x/sqrt(d3$x)
pd <- position_dodge(0.1)
p <- ggplot(d1, aes(x=date, y=mean, group = age, colour= age))
p <- p + geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), colour="black", width=.2, position=pd)
p <- p + geom_line(position=pd)
p <- p + geom_point(position=pd, size=3, shape=21, fill="white")
p <- p + theme_classic() + labs(y = "Score de d?pression (m +/- sem)", x = "Date de visite")
p <- p + theme(axis.title.x = element_text(size=14),axis.title.y = element_text(size=14))
p <- p + theme(axis.text.x = element_text(size=14),axis.text.y = element_text(size=14))
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
d1 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=mean)
names(d1) <- c("date","age","mean")
d2 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=sd)
d3 <- aggregate(scl$depression,by=list(scl$VISIT,scl$age>30),FUN=length)
d1$sem <- d2$x/sqrt(d3$x)
pd <- position_dodge(0.1)
p <- ggplot(d1, aes(x=date, y=mean, group = age, colour= age))
p <- p + geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), colour="black", width=.2, position=pd)
p <- p + geom_line(position=pd)
p <- p + geom_point(position=pd, size=3, shape=21, fill="white")
p <- p + theme_classic() + labs(y = "Score de dépression (m +/- sem)", x = "Date de visite")
p <- p + theme(axis.title.x = element_text(size=14),axis.title.y = element_text(size=14))
p <- p + theme(axis.text.x = element_text(size=14),axis.text.y = element_text(size=14))
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
#p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
#p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
#p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Dur?e de suivie en jours")
#p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
#p
CairoWin()
#p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
#p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
#p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Dur?e de suivie en jours")
#p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
#p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = age>30), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = age>30), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
rm(list=ls())
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, somatisation, group = NUMERO, color = as.factor(SEXE)))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = as.factor(SEXE)), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de somatisation", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Sexe", labels=c("hommes", "femmes"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_line(alpha = 0.4) + geom_smooth(aes(group = age>30), se = FALSE)
p <- p + theme_classic() + labs(y = "Score de dépression", x = "Durée de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
p <- ggplot(na.omit(scl), aes(JOUR.VISIT, depression, group = NUMERO, color = age>30))
p <- p + geom_smooth(aes(group = age>30, fill = age>30))
p <- p + guides( fill = FALSE)     #To remove legend for fill aesthetic
p <- p + theme_classic() + labs(y = "Score de d?pression", x = "Dur?e de suivie en jours")
p <- p + scale_color_discrete(name="Age", labels=c("< 30 ans", "> 30 ans"))
p
View(smp)
list=ls()
acp <- smp[,c("schizophrenie","depression","tbl.bipol","anxiete.gen","stress.trauma",
"att.panique","agoraphobie","toc","phobie.soc","alcoolisme","abus.subst")]
#mdspca(acp)
sphpca(acp)
sphpca(smp[,c(75:79,81:85,87:91)],h=-40)
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualit?","ralenti","agit?","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
CairoWin()
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualit?","ralenti","agit?","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, legend=FALSE,
layout="spring", edge.color=rgb(0,0.5,0.5),edge.width=0.5)
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualit?","ralenti","agit?","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
noms <- c("insomnie.deb","insomnie.mil", "insomnie.fin",
"hypersomnie","triste","irritable","anxieux","reactif","variation.hum","humeur.dep",
"appetit","poids","concentration","estime.soi","pessimisme","suicide","motivation",
"energie","plaisir","sexualité","ralenti","agité","somatisation","excitable","panique","gastro")
qgraph(cor(rush[,3:28], use="complete.obs"), minimum = 0.25, borders = FALSE, vsize = 4,
layout="spring", labels=noms, label.cex=5, label.scale.equal=TRUE, edge.color=rgb(0,0.5,0.5),edge.width=0.5)
acp <- smp[,c("schizophrenie","depression","tbl.bipol","anxiete.gen","stress.trauma",
"att.panique","agoraphobie","toc","phobie.soc","alcoolisme","abus.subst")]
mdspca(acp)
sphpca(acp)
sphpca(smp[,c(75:79,81:85,87:91)],h=-40)
acp <- smp[,c("schizophrenie","depression","tbl.bipol","anxiete.gen","stress.trauma",
"att.panique","agoraphobie","toc","phobie.soc","alcoolisme","abus.subst")]
mdspca(acp)
sphpca(acp)
somatisation <- c(1, 4, 12, 27, 42, 48, 49, 52, 53, 56, 58, 40)
obsession <- c(9, 10, 28, 38, 3, 45, 46, 51, 55, 65)
sensitivite <- c(6, 21, 34, 36, 37, 41, 61, 69, 73)
depression <- c(5, 14, 15, 20, 22, 26, 29, 30, 31, 32, 54, 71, 79)
anxiete <- c(2, 17, 23, 33, 39, 57, 72, 78, 80, 86)
hostilite <- c(11, 24, 63, 67, 74, 81)
phobie <- c(13, 25, 47, 70, 75, 82, 50)
paranoia <- c(8, 18, 43, 68, 76, 83)
psychose <- c(7, 16, 35, 62, 77, 84, 85, 87, 90, 88)
divers <- c(19, 44, 59, 60, 64, 66, 89)
scl.dim <- scl[,5+c(somatisation,obsession,sensitivite,depression,anxiete,hostilite,phobie,paranoia,psychose,divers)]
library(viridisLite)
dsph <- function(x) {as.dist(0.5*(1-x)^2)}
heatmap(cor(na.omit(scl.dim)), col=viridis(255), scale="none", distfun=dsph, Rowv=NA, Colv=NA,
cexRow=0.7, cexCol=0.7, labRow=substring(names(scl.dim), 2, 20), labCol=substring(names(scl.dim), 2, 20))
legend(x="right", legend=(-5:5)/5, fill=viridis(11))
library(reshape2)
scl.w <- dcast(scl[,c("NUMERO","VISIT","depression")], NUMERO~VISIT, value.var="depression")
scl.w <- scl.w[,-c(1,10)]
int <- scl.w
int[is.na(int)] <- 0
couleurs <- viridis(255)
couleurs[1] <- "#000000FF"
CairoWin()
library(reshape2)
scl.w <- dcast(scl[,c("NUMERO","VISIT","depression")], NUMERO~VISIT, value.var="depression")
scl.w <- scl.w[,-c(1,10)]
int <- scl.w
int[is.na(int)] <- 0
couleurs <- viridis(255)
couleurs[1] <- "#000000FF"
heatmap(as.matrix(int), col=couleurs, scale="none", Rowv=NULL, Colv=NA)
install.packages("reshape2")
install.packages("reshape2")
library(ape)
library(igraph)
wc <-apply(tdm3,2,sum,na.rm=TRUE)
library(ape)
library(igraph)
wc <-apply(tdm2,2,sum,na.rm=TRUE)
phylo_tree <- as.phylo(clus.ph)
tdm2
library(ape)
library(igraph)
wc <-apply(tdm2,2,sum,na.rm=TRUE)
phylo_tree <- as.phylo(clus.ph)
View(tdm2)
ls()
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
library(Cairo)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
1 + 1
reticulate::repl_python()
rm(list=ls())
#| label: setup
#| include: false
#| echo: false
library(forecast)
library(plotrix)
library(viridisLite)
library(ggplot2)
library(survminer)
library(treemap)
library(psy)
library(qgraph)
library(ape)
library(survival)
library(httpgd)
library(psy)
knitr::opts_chunk$set(echo = TRUE)
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/CUSM")
gs <- read.csv2("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/GoogleSuicide20172022.csv")
load("~/Documents/Projets/M2biostatistiques/Cours/CUSM_data/dataAQRlivre")
data(expsy)
alzh = read.csv("~/Documents/Projets/M2biostatistiques/Cours/alzheimer.csv")
#| label: survie_no_censure
library(survival)
# 1) Données
temps <- c(13, 13, 14, 13, 15, 11, 17, 13, 14, 15)
# Comme il n'y a PAS de censure : event = 1 pour tout le monde
event <- rep(1, length(temps))
# Objet Surv
surv_object <- Surv(time = temps, event = event)
# 2) Estimation de la fonction de survie
surv_fit <- survfit(surv_object ~ 1)
# 3) Tracé de la fonction de survie
plot(
surv_fit,
xlab = "Temps (mois)",
ylab = "Probabilité de survie S(t)",
main = "Fonction de survie sans censure")
#| label: survie_no_censure_simule
T = floor(runif(80,0,50)) # runif génère 1000 temps de survie entre 0 et 50 qui sont arrondis à l'entier inférieur avec floor
head(T)
table(T)
#| label: survie_no_censure_simule2
tt <- unique(T)
length(tt) # 39 valeurs uniques
#| label: survie_no_censure_simule2b
tt <- sort(tt)
tt
#| label: survie_no_censure_simule3
head(T > 10)
mean(T > 10) # proportion de TRUE = proportion de survivants au delà de 10
#| label: survie_no_censure_simule4
S <- function(t) mean(T > t)
#| label: survie_no_censure_simule5
S(10) # proportion de survivants au delà de 10
S(20) # proportion de survivants au delà de 20
#| label: survie_no_censure_simule6
S_values <- sapply(tt, S)
S_values
#| label: survie_no_censure_simule7
plot(
tt, # x values = temps
S_values, # y values = probabilité de survie S(t) calculée
type="s", # type = "s" pour une fonction en escalier
xlab="Temps",
ylab="Probabilité de survie S(t)",
main="Fonction de survie sans censure (simulée)")
#| label: survie_censure_data
library(survival)
#| label: survie_censure_data2
head(lung) # afficher les premières lignes
#| label: survie_censure_data3
Surv(lung$time, lung$status)
#| label: survie_censure_km
fit <- survfit(Surv(lung$time, lung$status)~ 1)
fit
#| label: survie_censure_km_plot
plot(
fit,
xlab = "Temps (jours)",
ylab = "Probabilité de survie S(t)",
main = "Courbe de survie Kaplan-Meier")
#| label: survie_censure_km_summary
summary(fit)
#| label: survie_censure_km_ggsurvplot
library(survminer)
ggsurvplot(fit, data = lung)
#| label: survie_censure_km_sex
fit_sex <- survfit(Surv(time, status) ~ sex, data = lung)
fit_sex
#| label: survie_censure_km_sex_plot
plot(
fit_sex,
xlab = "Temps (jours)",
ylab = "Probabilité de survie S(t)",
main = "Courbe de survie Kaplan-Meier par sexe",
col = c("blue", "deeppink"),
conf.int = FALSE # pas d'intervalle de confiance
)
#| label: survie_censure_km_sex_ggsurvplot
ggsurvplot(
fit_sex,
data = lung,
conf.int = TRUE,
pval = TRUE,
risk.table = TRUE,
risk.table.col = "strata",
legend.labs = c("Homme", "Femme"),
legend.title = "Sexe",
palette = c("blue", "deeppink"),
surv.median.line = "hv"
)
#| label: logrank_test
# Charger les librairies nécessaires
library(survival)
library(survminer)
# Créer un objet Surv
surv_object <- Surv(time = lung$time, event = lung$status)
# Ajuster le modèle de survie par sexe
surv_fit <- survfit(surv_object ~ lung$sex)
# Effectuer le test de Log-Rank : fonction survdiff
logrank_test <- survdiff(surv_object ~ lung$sex)
# Afficher les résultats du test
print(logrank_test)
#| label: cox_model_example
# Charger la librairie survival
library(survival)
# Afficher les premières lignes du jeu de données
head(lung)
# Créer un objet Surv
surv_obj <- Surv(time = lung$time, event = lung$status)
surv_obj
# Test de Log-Rank pour le sexe
logrank_sex <- survdiff(surv_obj ~ lung$sex)
print(logrank_sex)
# Ajuster un modèle de Cox avec le sexe comme covariable
cox_model_sex <- coxph(surv_obj ~ lung$sex)
summary(cox_model_sex)
# Calculer les coefficients ß
coefficients(cox_model_sex)
# Exponentielle (hazard ratio)
exp(coefficients(cox_model_sex))
# Obtenir l'intervalle de confiance à 95 % pour les coefficients
confint(cox_model_sex)
# Obtenir l'intervalle de confiance à 95 % pour le hazard ratio
exp(confint(cox_model_sex))
# Obtenir la fonction de risque de base estimée
base_hazard <- basehaz(cox_model_sex, centered = FALSE)
head(base_hazard)
# Charger la librairie survival
library(MASS)
# Afficher les premières lignes des données
head(gehan,20)
# Résumé des événements et censures par groupe de traitement
table(gehan$treat, gehan$cens, dnn = c("Traitement", "Censure"))
surv_object_gehan <- Surv(time = gehan$time, event = gehan$cens)
surv_object_gehan
surv_fit_gehan <- survfit(surv_object_gehan ~ gehan$treat, data = gehan)
surv_fit_gehan
summary_gehan_12_18 <- summary(surv_fit_gehan, times = c(12, 18))
summary_gehan_12_18
summary_gehan_6_12 <- summary(surv_fit_gehan, times = c(6, 12))
summary_gehan_6_12
# Obtenir la médiane de survie pour chaque groupe
surv_fit_gehan
# Tracer les courbes de survie
plot(surv_fit_gehan, col = c("blue", "red"), lty = 1:2,
xlab = "Temps (semaines)", ylab = "Probabilité de survie",
main = "Courbes de survie de Kaplan-Meier par groupe de traitement")
legend("topright", legend = levels(gehan$treat), col = c("blue", "red"), lty = 1:2)
# Charger la librairie survminer pour une meilleure visualisation
library(survminer)
# Tracer les courbes de survie avec ggsurvplot
ggsurvplot(surv_fit_gehan, data = gehan,
pval = TRUE, conf.int = TRUE,
risk.table = TRUE,
xlab = "Temps (semaines)",
ylab = "Probabilité de survie",
title = "Courbes de survie de Kaplan-Meier par groupe de traitement",
legend.labs = levels(gehan$treat),
palette = c("blue", "red"),
surv.median.line = "hv")
# Effectuer le test de Log-Rank
logrank_test <- survdiff(surv_object_gehan ~ gehan$treat)
print(logrank_test)
# Charger la librairie MASS
library(MASS)
# Afficher les premières lignes des données Melanoma
head(Melanoma)
Melanoma$status2 <- ifelse(Melanoma$status == 2, 0, 1)
surv_object_melanoma <- Surv(time = Melanoma$time, event = Melanoma$status2 == 1)
surv_object_melanoma
surv_fit_melanoma <- survfit(surv_object_melanoma ~ 1, data = Melanoma)
surv_fit_melanoma
# Charger la librairie survminer pour une meilleure visualisation
library(survminer)
# Tracer la courbe de survie globale
ggsurvplot(surv_fit_melanoma,
data = Melanoma,
conf.int = TRUE,
risk.table = TRUE,
xlab = "Temps (mois)",
ylab = "Probabilité de survie",
title = "Courbe de survie de Kaplan-Meier globale",
palette = "darkblue"
)
surv_fit_sex <- survfit(surv_object_melanoma ~ Melanoma$sex, data = Melanoma)
surv_fit_sex
# Tracer les courbes de survie par sexe
ggsurvplot(
surv_fit_sex,
data = Melanoma,
pval = TRUE,
conf.int = TRUE,
risk.table = TRUE,
xlab = "Temps (mois)",
ylab = "Probabilité de survie",
title = "Courbes de survie de Kaplan-Meier par sexe",
legend.labs = c("Femmes", "Hommes"),
palette = c("deeppink", "blue"),
surv.median.line = "hv",
risk.table.height = 0.25,
risk.table.y.text.col = TRUE,
risk.table.y.text = FALSE,
censor = TRUE
)
# Effectuer le test de Log-Rank
logrank_test_sex <- survdiff(surv_object_melanoma ~ Melanoma$sex)
print(logrank_test_sex)
# Ajuster un modèle de Cox avec le sexe comme covariable
cox_model_sex <- coxph(surv_object_melanoma ~ Melanoma$sex)
summary(cox_model_sex)
# Ajuster un modèle de Cox avec le sexe et l'épaisseur de la tumeur comme covariables
cox_model_sex_thickness <- coxph(surv_object_melanoma ~ Melanoma$sex + Melanoma$thickness)
summary(cox_model_sex_thickness)
